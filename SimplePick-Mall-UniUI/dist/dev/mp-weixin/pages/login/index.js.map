{"version":3,"file":"index.js","sources":["../../../../../src/pages/login/index.vue","../../../../../uniPage:/cGFnZXMvbG9naW4vaW5kZXgudnVl"],"sourcesContent":["<script setup lang=\"ts\">\nimport { postLoginAPI, postLoginWxMinAPI, login } from '@/services/login'\nimport { useMemberStore } from '@/stores'\nimport { onLoad } from '@dcloudio/uni-app'\nimport { ref } from 'vue'\n\n\n// 获取 code 登录凭证\nlet code = ''\nonLoad(async () => {\n  const res = await wx.login()\n  code = res.code\n})\n\n// 获取用户手机号码\nconst onGetphonenumber: UniHelper.ButtonOnGetphonenumber = async (ev) => {\n  const { encryptedData, iv } = ev.detail\n  const res = await postLoginWxMinAPI({ code, encryptedData, iv })\n  loginSuccess(res.result)\n}\n\n\n// 模拟手机号码快捷登录（开发练习）\nconst onGetphonenumberSimple = async () => {\n  const myInfo = {\n    username: 'codeanl',\n    password: '123456',\n  }\n  const res = await login(myInfo)\n  if (res.code == 200) {\n    loginSuccess(res.data)\n  }\n}\nconst loginSuccess = (profile: any) => {\n  // 保存会员信息\n  const memberStore = useMemberStore()\n  memberStore.setProfile(profile)\n  // 成功提示\n  uni.showToast({ icon: 'success', title: '登录成功' })\n  setTimeout(() => {\n    // 页面跳转\n    // uni.switchTab({ url: '/pages/my/my' })\n    uni.navigateBack()\n  }, 500)\n}\n\n\n// 传统表单登录，测试账号：13123456789 密码：123456，测试账号仅开发学习使用。\nconst form = ref({\n  username: 'codeanl',\n  password: '123456',\n})\n\n// 表单提交\nconst onSubmit = async () => {\n  // const res = await postLoginAPI(form.value)\n  // loginSuccess(res.result)\n  console.log(form)\n  const res = await login(form.value)\n  if (res.code == 200) {\n    loginSuccess(res.data)\n  }\n}\n\n</script>\n\n<template>\n  <view class=\"viewport\">\n    <view class=\"logo\">\n      <image src=\"http://rz9o6lxu1.hd-bkt.clouddn.com/1693992736\"></image>\n    </view>\n    <view class=\"login\">\n      <!-- 网页端表单登录 -->\n\n      <input\n        v-model=\"form.username\"\n        class=\"input\"\n        type=\"text\"\n        placeholder=\"请输入用户名/手机号码\"\n      />\n      <input v-model=\"form.password\" class=\"input\" type=\"text\" password placeholder=\"请输入密码\" />\n      <button @click=\"onSubmit\" class=\"button phone\">登录</button>\n\n\n      <!-- 小程序端授权登录 -->\n\n      <!-- <button class=\"button phone\" open-type=\"getPhoneNumber\" @getphonenumber=\"onGetphonenumber\">\n        <text class=\"icon icon-phone\"></text>\n        手机号快捷登录\n      </button> -->\n\n      <view class=\"extra\">\n        <view class=\"caption\">\n          <text>其他登录方式</text>\n        </view>\n        <view class=\"options\">\n          <!-- 通用模拟登录 -->\n          <button @tap=\"onGetphonenumberSimple\">\n            <text class=\"icon icon-phone\">快捷登录</text>\n          </button>\n        </view>\n      </view>\n      <view class=\"tips\">登录/注册即视为你同意《服务条款》和《隐私协议》</view>\n    </view>\n  </view>\n</template>\n\n<style lang=\"scss\">\npage {\n  height: 100%;\n}\n\n.viewport {\n  display: flex;\n  flex-direction: column;\n  height: 100%;\n  padding: 20rpx 40rpx;\n}\n\n.logo {\n  flex: 1;\n  text-align: center;\n\n  image {\n    width: 220rpx;\n    height: 220rpx;\n    margin-top: 15vh;\n  }\n}\n\n.login {\n  display: flex;\n  flex-direction: column;\n  height: 60vh;\n  padding: 40rpx 20rpx 20rpx;\n\n  .input {\n    width: 100%;\n    height: 80rpx;\n    font-size: 28rpx;\n    border-radius: 72rpx;\n    border: 1px solid #ddd;\n    padding-left: 30rpx;\n    margin-bottom: 20rpx;\n  }\n\n  .button {\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    width: 100%;\n    height: 80rpx;\n    font-size: 28rpx;\n    border-radius: 72rpx;\n    color: #fff;\n\n    .icon {\n      font-size: 40rpx;\n      margin-right: 6rpx;\n    }\n  }\n\n  .phone {\n    background-color: #28bb9c;\n  }\n\n  .wechat {\n    background-color: #06c05f;\n  }\n\n  .extra {\n    flex: 1;\n    padding: 70rpx 70rpx 0;\n\n    .caption {\n      width: 440rpx;\n      line-height: 1;\n      border-top: 1rpx solid #ddd;\n      font-size: 26rpx;\n      color: #999;\n      position: relative;\n\n      text {\n        transform: translate(-40%);\n        background-color: #fff;\n        position: absolute;\n        top: -12rpx;\n        left: 50%;\n      }\n    }\n\n    .options {\n      display: flex;\n      justify-content: center;\n      align-items: center;\n      margin-top: 70rpx;\n\n      button {\n        padding: 0;\n        background-color: transparent;\n\n        &::after {\n          border: none;\n        }\n      }\n    }\n\n    .icon {\n      font-size: 24rpx;\n      color: #444;\n      display: flex;\n      flex-direction: column;\n      align-items: center;\n\n      &::before {\n        display: flex;\n        align-items: center;\n        justify-content: center;\n        width: 80rpx;\n        height: 80rpx;\n        margin-bottom: 6rpx;\n        font-size: 40rpx;\n        border: 1rpx solid #444;\n        border-radius: 50%;\n      }\n    }\n\n    .icon-weixin::before {\n      border-color: #06c05f;\n      color: #06c05f;\n    }\n  }\n}\n\n.tips {\n  position: absolute;\n  bottom: 80rpx;\n  left: 20rpx;\n  right: 20rpx;\n  font-size: 22rpx;\n  color: #999;\n  text-align: center;\n}\n</style>\n","import MiniProgramPage from '/Users/gygy/Desktop/毕业设计/SimplePick-Mall-UniUI/src/pages/login/index.vue'\nwx.createPage(MiniProgramPage)"],"names":["onLoad","wx","login","useMemberStore","uni","ref"],"mappings":";;;;;;;;;AASAA,kBAAAA,OAAO,YAAY;AACX,YAAA,MAAM,MAAMC,mBAAG;AACd,UAAI;AAAA,IAAA,CACZ;AAWD,UAAM,yBAAyB,YAAY;AACzC,YAAM,SAAS;AAAA,QACb,UAAU;AAAA,QACV,UAAU;AAAA,MAAA;AAEN,YAAA,MAAM,MAAMC,qBAAM,MAAM;AAC1B,UAAA,IAAI,QAAQ,KAAK;AACnB,qBAAa,IAAI,IAAI;AAAA,MACvB;AAAA,IAAA;AAEI,UAAA,eAAe,CAAC,YAAiB;AAErC,YAAM,cAAcC,sBAAAA;AACpB,kBAAY,WAAW,OAAO;AAE9BC,oBAAA,MAAI,UAAU,EAAE,MAAM,WAAW,OAAO,QAAQ;AAChD,iBAAW,MAAM;AAGfA,sBAAA,MAAI,aAAa;AAAA,SAChB,GAAG;AAAA,IAAA;AAKR,UAAM,OAAOC,cAAAA,IAAI;AAAA,MACf,UAAU;AAAA,MACV,UAAU;AAAA,IAAA,CACX;AAGD,UAAM,WAAW,YAAY;AAG3B,cAAQ,IAAI,IAAI;AAChB,YAAM,MAAM,MAAMH,eAAAA,MAAM,KAAK,KAAK;AAC9B,UAAA,IAAI,QAAQ,KAAK;AACnB,qBAAa,IAAI,IAAI;AAAA,MACvB;AAAA,IAAA;;;;;;;;;;;;;;AC5DF,GAAG,WAAW,eAAe;"}