/* empty css             *//* empty css                             *//* empty css                 *//* empty css               *//* empty css                  *//* empty css                  *//* empty css                  *//* empty css                    *//* empty css                *//* empty css                      *//* empty css                        *//* empty css                      *//* empty css                   *//* empty css                 *//* empty css                *//* empty css                     */import{at as F,d as Ie,a as n,r as Ne,aa as Te,b as qe,A as Me,o as D,c as L,e,w as t,f as s,M as _,h as u,C as Y,t as P,z as Oe,x as K,F as Re,a7 as m,k as je,m as Be,n as Fe,p as Ge,a5 as He,ay as Je,al as Le,am as Ye,an as Ke,ao as Qe,G as We,ac as Xe,ap as Ze,aj as $e,ak as el,ad as ll,ae as al}from"./index-bc94ad6c.js";import{a as tl,r as ne}from"./index-0e4c8d23.js";import{u as ol}from"./setting-343fd123.js";import{r as sl,R as nl}from"./index-66e03b3b.js";const rl=(v,w,f,V,q,y)=>F.get("/api/pms/merchants/list",{params:{current:v,pageSize:w,name:f,phone:V,address:q,principal:y}}),re=v=>v.id?F.post("/api/pms/merchants/update",v):F.post("/api/pms/merchants/add",v),ie=v=>F.post("/api/pms/merchants/delete",v),il=["src"],pl=["src"],dl={style:{flex:"auto"}},ul=["src"],cl=["src"],ml=["src"],fl=["src"],gl={key:0,style:{flex:"auto"}},Ml=Ie({__name:"index",setup(v){const w=n("");let f=n(1),V=n(10),q=n(0),y=n(1),I=n(5),M=n(0);const r=Ne({id:0,name:"",principal:"",phone:"",address:"",pic:""});let C=n(""),x=n(""),z=n(""),E=n(""),pe=n("");const de=n(""),h=async(o=1)=>{f.value=o;let l=await rl(f.value,V.value,C.value,E.value,z.value,x.value);l.code==200?(q.value=l.total,O.value=l.data,m({type:"success",message:l.message})):m({type:"error",message:l.message})};let U=n("0");const k=async(o=1)=>{y.value=o;let l=await tl(y.value,I.value,pe.value,U.value,"0");l.code==200&&(M.value=l.total,Q.value=l.data)};Te(()=>{h(),k()});let O=n([]),Q=n([]),W=n();const ue=()=>{h()},ce=()=>{k()};let G=n([]);const X=o=>{G.value=o};let R=n([]);const me=async o=>{R.value.push(o);const l={ids:R.value};let p=await ie(l);p.code==200?(h(O.value.length>1?f.value:f.value-1),m({type:"success",message:p.message})):m({type:"error",message:p.message})},fe=async()=>{R.value=G.value.map(p=>p.id);const o={ids:R.value};let l=await ie(o);l.code===200?(h(O.value.length>1?f.value:f.value-1),m({type:"success",message:l.message})):m({type:"error",message:l.message})};let S=n(!1),N=n(!1),b=n(!1);const ge=async o=>{S.value=!0,Object.keys(r).forEach(l=>{r[l]=Array.isArray(r[l])?[]:""}),Object.assign(r,o)},_e=o=>{r.pic=o.data,W.value.clearValidate("pic")},ve=o=>{if(o.type==="image/png"||o.type==="image/jpeg"||o.type==="image/gif"){if(o.size/1024/1024<4)return!0;m({type:"error",message:"上传的文件大小应小于4M"})}else return m({type:"error",message:"上传的文件类型必须是PNG|JPG|GIF"}),!1},ye=()=>{S.value=!1},he=async()=>{let o=await re(r);o.code==200?(S.value=!1,h(),m({type:"success",message:o.message})):m({type:"error",message:o.message})};let Z=ol();const be=()=>{Z.refresh=!Z.refresh},we=()=>{h(),C.value=""};let $=()=>{N.value=!0},i=n(),ee=n(!1),Ve=o=>{o.status=="0"&&(ee.value=!0),w.value="",b.value=!0,i.value=o},Ce=()=>{k()};const le=(()=>{const o=new Date,l=o.getFullYear(),p=String(o.getMonth()+1).padStart(2,"0"),g=String(o.getDate()).padStart(2,"0"),c=String(o.getHours()).padStart(2,"0"),j=String(o.getMinutes()).padStart(2,"0"),B=String(o.getSeconds()).padStart(2,"0");return`${l}-${p}-${g} ${c}:${j}:${B}`})();let ae=qe(),ke=async()=>{let o=await ne({id:i.value.id,status:"2",remarks:w.value,approver:ae.username,approvalTime:le});o.code===200?(b.value=!1,k(),m({type:"success",message:o.message})):m({type:"error",message:o.message})},Se=async()=>{b.value=!1;let o=await ne({id:i.value.id,status:"1",remarks:w.value,approver:ae.username,approvalTime:le});if(o.code==200){let l=await sl({username:i.value.principalPhone,phone:i.value.principalPhone,nickname:i.value.principalName,status:"1",gender:"0"});l.code==200&&(b.value=!1,k(),h(),await nl({id:l.data,roleId:[2]}),await re({name:i.value.name,principal:i.value.principalName,phone:i.value.principalPhone,address:i.value.address,pic:i.value.pic,userID:l.data})),m({type:"success",message:o.message})}else m({type:"error",message:o.message})},xe=o=>{U.value="0",k(),o()};return(o,l)=>{const p=je,g=Be,c=Fe,j=Ge,B=He,te=Je,d=Le,ze=Ye,oe=Ke,se=Qe,Ee=Me("Plus"),Ue=We,Ae=Xe,H=Ze,J=$e,De=el,A=ll,Pe=al;return D(),L(Re,null,[e(B,null,{default:t(()=>[e(j,{inline:!0,class:"form"},{default:t(()=>[e(g,{label:"名称:"},{default:t(()=>[e(p,{placeholder:"请输入搜索的名称",modelValue:s(C),"onUpdate:modelValue":l[0]||(l[0]=a=>_(C)?C.value=a:C=a)},null,8,["modelValue"])]),_:1}),e(g,{label:"负责人:"},{default:t(()=>[e(p,{placeholder:"请输入搜索的名称",modelValue:s(x),"onUpdate:modelValue":l[1]||(l[1]=a=>_(x)?x.value=a:x=a)},null,8,["modelValue"])]),_:1}),e(g,{label:"地址:"},{default:t(()=>[e(p,{placeholder:"请输入搜索的名称",modelValue:s(z),"onUpdate:modelValue":l[2]||(l[2]=a=>_(z)?z.value=a:z=a)},null,8,["modelValue"])]),_:1}),e(g,{label:"联系电话:"},{default:t(()=>[e(p,{placeholder:"请输入搜索的名称",modelValue:s(E),"onUpdate:modelValue":l[3]||(l[3]=a=>_(E)?E.value=a:E=a)},null,8,["modelValue"])]),_:1}),e(g,null,{default:t(()=>[e(c,{type:"primary",size:"default",onClick:we,disabled:!(s(C)||s(x)||s(z)||s(E))},{default:t(()=>[u(" 搜索 ")]),_:1},8,["disabled"]),e(c,{size:"default",onClick:be},{default:t(()=>[u("重置")]),_:1})]),_:1})]),_:1})]),_:1}),e(B,null,{default:t(()=>[e(c,{type:"danger",size:"default",onClick:fe,disabled:!s(G).length},{default:t(()=>[u(" 批量删除 ")]),_:1},8,["disabled"]),s(M)!=0?(D(),Y(te,{key:0,value:s(M),max:10,class:"item",style:{"margin-left":"10px"}},{default:t(()=>[e(c,{type:"primary",size:"default",icon:"Edit",onClick:s($)},{default:t(()=>[u("审核")]),_:1},8,["onClick"])]),_:1},8,["value"])):(D(),Y(c,{key:1,type:"primary",size:"default",icon:"Edit",onClick:s($)},{default:t(()=>[u("审核")]),_:1},8,["onClick"])),e(oe,{border:"",data:s(O),onSelectionChange:X,style:{margin:"15px 0"}},{default:t(()=>[e(d,{type:"selection",align:"center",width:"40px"}),e(d,{label:"id",align:"center",prop:"id",width:"50px"}),e(d,{label:"店铺图片",align:"center",prop:"pic","show-overflow-tooltip":"",width:"120px"},{default:t(({row:a})=>[P("img",{src:a.pic,alt:"店铺图片",style:{width:"100px",height:"auto"}},null,8,il)]),_:1}),e(d,{label:"名称",align:"center",prop:"name","show-overflow-tooltip":""}),e(d,{label:"负责人",align:"center",prop:"principal","show-overflow-tooltip":""}),e(d,{label:"联系电话",align:"center",prop:"phone","show-overflow-tooltip":""}),e(d,{label:"地址",align:"center",prop:"address","show-overflow-tooltip":""}),e(d,{label:"操作",width:"300px",align:"center"},{default:t(({row:a})=>[e(c,{type:"primary",size:"small",icon:"Edit",onClick:T=>ge(a)},{default:t(()=>[u(" 编辑 ")]),_:2},1032,["onClick"]),e(ze,{title:`你确定删除${a.name}`,width:"260px",onConfirm:T=>me(a.id)},{reference:t(()=>[e(c,{type:"danger",size:"small",icon:"Delete"},{default:t(()=>[u(" 删除 ")]),_:1})]),_:2},1032,["title","onConfirm"])]),_:1})]),_:1},8,["data"]),e(se,{"current-page":s(f),"onUpdate:currentPage":l[4]||(l[4]=a=>_(f)?f.value=a:f=a),"page-size":s(V),"onUpdate:pageSize":l[5]||(l[5]=a=>_(V)?V.value=a:V=a),"page-sizes":[5,10,15,20],background:!0,layout:"prev, pager, next, jumper, -> , sizes, total",total:s(q),onCurrentChange:h,onSizeChange:ue},null,8,["current-page","page-size","total"])]),_:1}),e(H,{modelValue:s(S),"onUpdate:modelValue":l[10]||(l[10]=a=>_(S)?S.value=a:S=a),title:r.id?"更新":"添加",width:"70%"},{footer:t(()=>[P("div",dl,[e(c,{onClick:ye},{default:t(()=>[u("取消")]),_:1}),e(c,{type:"primary",onClick:he},{default:t(()=>[u("确定")]),_:1})])]),default:t(()=>[e(j,{model:r,ref_key:"formRef",ref:W},{default:t(()=>[e(g,{label:"名称",prop:"name"},{default:t(()=>[e(p,{placeholder:"请您输入名称",modelValue:r.name,"onUpdate:modelValue":l[6]||(l[6]=a=>r.name=a)},null,8,["modelValue"])]),_:1}),e(g,{label:"负责人",prop:"principal"},{default:t(()=>[e(p,{placeholder:"请您输入负责人",modelValue:r.principal,"onUpdate:modelValue":l[7]||(l[7]=a=>r.principal=a)},null,8,["modelValue"])]),_:1}),e(g,{label:"联系电话",prop:"phone"},{default:t(()=>[e(p,{placeholder:"联系电话",modelValue:r.phone,"onUpdate:modelValue":l[8]||(l[8]=a=>r.phone=a)},null,8,["modelValue"])]),_:1}),e(g,{label:"地址",prop:"address"},{default:t(()=>[e(p,{placeholder:"地址",modelValue:r.address,"onUpdate:modelValue":l[9]||(l[9]=a=>r.address=a)},null,8,["modelValue"])]),_:1}),e(g,{label:"商品封面",prop:"pic"},{default:t(()=>[e(Ae,{class:"avatar-uploader",action:"/api/api/sys/upload","show-file-list":!1,"on-success":_e,"before-upload":ve},{default:t(()=>[r.pic?(D(),L("img",{key:0,src:r.pic,class:"avatar"},null,8,pl)):(D(),Y(Ue,{key:1,class:"avatar-uploader-icon"},{default:t(()=>[e(Ee)]),_:1}))]),_:1})]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"]),e(H,{modelValue:s(N),"onUpdate:modelValue":l[14]||(l[14]=a=>_(N)?N.value=a:N=a),width:"70%","before-close":s(xe)},{default:t(()=>[e(De,{modelValue:s(U),"onUpdate:modelValue":l[11]||(l[11]=a=>_(U)?U.value=a:U=a),class:"m-2",placeholder:"请选择状态",onChange:s(Ce)},{default:t(()=>[e(J,{label:"待审核",value:"0"}),e(J,{label:"已同意",value:"1"}),e(J,{label:"已拒绝",value:"2"})]),_:1},8,["modelValue","onChange"]),e(oe,{border:"",data:s(Q),onSelectionChange:X,style:{margin:"15px 0"}},{default:t(()=>[e(d,{type:"selection",align:"center",width:"30px"}),e(d,{label:"id",align:"center",prop:"id",width:"50px"}),e(d,{label:"店铺图片",align:"center",prop:"pic","show-overflow-tooltip":"",width:"120px"},{default:t(({row:a})=>[P("img",{src:a.pic,alt:"店铺图片",style:{width:"100px",height:"auto"}},null,8,ul)]),_:1}),e(d,{label:"名称",align:"center",prop:"name","show-overflow-tooltip":""}),e(d,{label:"负责人",align:"center",prop:"principalName","show-overflow-tooltip":""}),e(d,{label:"联系电话",align:"center",prop:"principalPhone","show-overflow-tooltip":""}),e(d,{label:"地址",align:"center",prop:"address","show-overflow-tooltip":""}),e(d,{label:"操作",width:"300px",align:"center"},{default:t(({row:a})=>[e(c,{type:"primary",size:"small",icon:"Edit",onClick:T=>s(Ve)(a)},{default:t(()=>[u(" 查看详情 ")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"]),e(se,{"current-page":s(y),"onUpdate:currentPage":l[12]||(l[12]=a=>_(y)?y.value=a:y=a),"page-size":s(I),"onUpdate:pageSize":l[13]||(l[13]=a=>_(I)?I.value=a:I=a),"page-sizes":[5,10,15,20],background:!0,layout:"prev, pager, next, jumper, -> , sizes, total",total:s(M),onCurrentChange:k,onSizeChange:ce},null,8,["current-page","page-size","total"])]),_:1},8,["modelValue","before-close"]),e(H,{modelValue:s(b),"onUpdate:modelValue":l[16]||(l[16]=a=>_(b)?b.value=a:b=a),width:"70%",title:"店铺申请详情"},{footer:t(()=>[s(ee)?(D(),L("div",gl,[e(c,{onClick:s(ke)},{default:t(()=>[u("拒绝")]),_:1},8,["onClick"]),e(c,{type:"primary",onClick:s(Se)},{default:t(()=>[u("同意")]),_:1},8,["onClick"])])):Oe("",!0)]),default:t(()=>[e(Pe,{direction:"horizontal",column:1,size:de.value,border:""},{default:t(()=>[e(A,{label:"图片"},{default:t(()=>[P("img",{src:s(i).pic,alt:"",style:{width:"200px"}},null,8,cl)]),_:1}),e(A,{label:"收货人"},{default:t(()=>[u(K(s(i).principalName),1)]),_:1}),e(A,{label:"联系电话"},{default:t(()=>[u(K(s(i).principalPhone),1)]),_:1}),e(A,{label:"地址"},{default:t(()=>[u(K(s(i).address),1)]),_:1}),e(A,{label:"身份证正反面"},{default:t(()=>{var a,T;return[P("img",{src:(a=s(i))==null?void 0:a.IDCardFront,alt:"",style:{width:"200px"}},null,8,ml),P("img",{src:(T=s(i))==null?void 0:T.IDCardReverse,alt:"",style:{width:"200px"}},null,8,fl)]}),_:1}),e(A,{label:"备注"},{default:t(()=>[e(p,{modelValue:w.value,"onUpdate:modelValue":l[15]||(l[15]=a=>w.value=a),placeholder:"请填写备注",clearable:""},null,8,["modelValue"])]),_:1})]),_:1},8,["size"])]),_:1},8,["modelValue"])],64)}}});export{Ml as default};
