/* empty css             *//* empty css                          *//* empty css                        *//* empty css                  *//* empty css                    *//* empty css                *//* empty css                      *//* empty css                 *//* empty css               *//* empty css                  *//* empty css                  *//* empty css                      *//* empty css                   *//* empty css                *//* empty css                     *//* empty css                */import{r as be}from"./index-34640b16.js";import{r as Me,a as ye,b as Ne,c as He,d as Je,e as Qe}from"./index-5d6ed19d.js";import{r as We}from"./index-2b6b338a.js";import{r as Xe}from"./index-b9f34230.js";import{u as Ye}from"./setting-343fd123.js";import{d as Ze,a as n,r as Ve,aa as $e,A as el,o as c,c as C,e as l,w as t,f as u,M as y,h as _,t as I,C as A,F as D,B as G,a7 as b,k as ll,m as al,aw as tl,aj as ol,ak as rl,n as ul,p as sl,a5 as dl,al as il,am as nl,an as pl,ao as cl,G as ml,ac as fl,ap as gl,aq as vl,ar as _l,q as bl,s as yl,_ as Vl}from"./index-bc94ad6c.js";const ee=J=>(bl("data-v-261f7c31"),J=J(),yl(),J),Ul=["src"],kl=["src"],hl=ee(()=>I("h2",null,"照片墙",-1)),Il=["src"],wl=ee(()=>I("h2",null,"介绍照片墙",-1)),Cl=["src"],Sl=ee(()=>I("h2",null,"属性",-1)),xl=ee(()=>I("h2",null,"规格（修改时如果不修改sku无需填写）",-1)),Al={style:{flex:"auto"}},Pl=["src"],El=["src"],zl={style:{flex:"auto"}},Tl=Ze({__name:"index",setup(J){let P=n(""),E=n(),L=n(),q=n(),O=n(),V=n(1),K=n(10),ue=n(0);const Ue=()=>{S()},o=Ve({id:0,categoryId:0,name:"",pic:"",desc:"",price:"",originalPrice:0,unit:"",productSn:"",subTitle:"",attributeValue:[],size:[{name:"",sizeValue:[]}],imgUrl:[],introduceImgUrl:[],attributeType1:[],attributeType2:[],attributeValueList:[],attributeCategoryID:0});let d=Ve({productId:0,name:"",pic:"",skuSn:"",subTitle:"",description:"",stock:0,price:"",AttributeShopValueID:[],sizeList:[]});$e(()=>{S()});let Q=n([]),le=n([]),se=n([]);const S=async(r=1)=>{V.value=r;let e=await Me(V.value,K.value,P.value,E.value,L.value,q.value,O.value);e.code==200&&(ue.value=e.total,Q.value=e.data);let s=await We();s.code===200&&(le.value=s.data)};let de=async r=>{let e=await be(1,100,"","1",r),s=await be(1,100,"","2",r);e.code==200&&(o.attributeType1=e.data),s.code==200&&(o.attributeType2=s.data),ie()},ie=async()=>{let r=await Xe();r.code===200&&(se.value=r.data)},ae=n([]);const ke=r=>{ae.value=r};let W=n([]);const he=async()=>{W.value=ae.value.map(s=>s.id);const r={ids:W.value};let e=await ye(r);e.code===200?(S(Q.value.length>1?V.value:V.value-1),b({type:"success",message:e.message})):b({type:"error",message:e.message})},Ie=async r=>{W.value.push(r);const e={ids:W.value};let s=await ye(e);s.code==200?(S(Q.value.length>1?V.value:V.value-1),b({type:"success",message:s.message})):b({type:"error",message:s.message})};let x=n(!1),z=n(!1),T=n(!1);const we=()=>{x.value=!1},j=n([]),F=n([]),Ce=()=>{x.value=!0,j.value=[],F.value=[],Object.keys(o).forEach(r=>{o[r]=Array.isArray(o[r])?[]:""}),U.value=[],w.value=[],ie()},Se=async r=>{var s,i,R,k,B,m,h,M,p,X;console.log(r.id),x.value=!0,Object.keys(o).forEach(f=>{o[f]=Array.isArray(o[f])?[]:""}),U.value=[],w.value=[],j.value=[],F.value=[];let e=await Ne({id:r.id});e.code==200&&(o.size=[],Object.assign(o,{id:(s=e.data.product_info)==null?void 0:s.id,categoryId:(i=e.data.product_info)==null?void 0:i.categoryId,name:(R=e.data.product_info)==null?void 0:R.name,pic:(k=e.data.product_info)==null?void 0:k.pic,desc:(B=e.data.product_info)==null?void 0:B.desc,price:(m=e.data.product_info)==null?void 0:m.price,originalPrice:(h=e.data.product_info)==null?void 0:h.originalPrice,unit:(M=e.data.product_info)==null?void 0:M.unit,productSn:(p=e.data.product_info)==null?void 0:p.productSn,attributeValue:e.data.attributeValue,imgUrl:e.data.imgUrl,introduceImgUrl:e.data.introduceImgUrl,attributeCategoryID:e.data.product_info.attributeCategoryID}),de((X=e.data.product_info)==null?void 0:X.attributeCategoryID),j.value=o.imgUrl.map(f=>({name:f.substring(f.lastIndexOf("/")+1),url:f})),F.value=o.introduceImgUrl.map(f=>({name:f.substring(f.lastIndexOf("/")+1),url:f})),e.data.attributeValue.attributeType1.length>0&&(U.value=e.data.attributeValue.attributeType1.map(f=>f.values[0].value)))};let U=n(),w=n(),ne=r=>r.split(",");const xe=async()=>{if(U.value=U.value.map((e,s)=>({attributeID:o.attributeType1[s].id,value:[e]})),w.value=w.value.map((e,s)=>({attributeID:o.attributeType2[s].id,value:e})),w.value[0])for(let e=0;e<w.value.length;e++)o.attributeValueList.push(w.value[e]);for(let e=0;e<U.value.length;e++)o.attributeValueList.push(U.value[e]);o.originalPrice=parseFloat(o.originalPrice),o.price=parseFloat(o.price);let r=await He(o);r.code==200?(x.value=!1,S(),b({type:"success",message:r.message})):b({type:"error",message:r.message})},pe=n(""),ce=n(""),te=n(!1),oe=n(!1),Ae=r=>{pe.value=r.url,te.value=!0},Pe=r=>{ce.value=r.url,oe.value=!0},Ee=(r,e)=>{console.log(e),o.imgUrl=o.imgUrl.filter(s=>s!==r.url)},ze=(r,e)=>{console.log(e),o.introduceImgUrl=o.introduceImgUrl.filter(s=>s!==r.url)};let re=n();const me=r=>{o.pic=r.data,d.pic=r.data,re.value.clearValidate("pic"),d.value.clearValidate("pic")},Te=r=>{o.imgUrl.push(r.data),o.imgUrl.value.clearValidate("imgUrl")},De=r=>{o.introduceImgUrl===null&&(o.introduceImgUrl=[]),o.introduceImgUrl.push(r.data),o.introduceImgUrl.value.clearValidate("introduceImgUrl")},fe=r=>{if(r.type==="image/png"||r.type==="image/jpeg"||r.type==="image/gif"){if(r.size/1024/1024<4)return!0;b({type:"error",message:"上传的文件大小应小于4M"})}else return b({type:"error",message:"上传的文件类型必须是PNG|JPG|GIF"}),!1};let ge=n([]),ve=async r=>{z.value=!0;let e=await Je({productID:r});e.code==200?(ge.value=e.data,b({type:"success",message:e.message})):b({type:"error",message:e.message})};const Le=r=>{T.value=!0,z.value=!1,Object.assign(d,r)},qe=()=>{T.value=!1,z.value=!0},Oe=async()=>{d.stock=parseInt(d.stock),d.price=parseFloat(d.price);let r=await Qe(d);r.code==200?(T.value=!1,ve(d.productId),S(),b({type:"success",message:r.message})):b({type:"error",message:r.message})};let Re=()=>{o.attributeType1=[],o.attributeType2=[],U.value=[],de(o.attributeCategoryID)},_e=Ye();const Be=()=>{_e.refresh=!_e.refresh},Ge=()=>{S(),P.value="",E.value=0};return(r,e)=>{const s=ll,i=al,R=tl,k=ol,B=rl,m=ul,h=sl,M=dl,p=il,X=nl,f=pl,Ke=cl,Y=el("Plus"),Z=ml,$=fl,N=gl,je=vl,Fe=_l;return c(),C(D,null,[l(M,null,{default:t(()=>[l(h,{inline:!0,class:"form"},{default:t(()=>[l(i,{label:"名称:"},{default:t(()=>[l(s,{placeholder:"请输入搜索的用户名",modelValue:u(P),"onUpdate:modelValue":e[0]||(e[0]=a=>y(P)?P.value=a:P=a)},null,8,["modelValue"])]),_:1}),l(i,{label:"分类:"},{default:t(()=>[l(R,{modelValue:u(E),"onUpdate:modelValue":e[1]||(e[1]=a=>y(E)?E.value=a:E=a),data:u(le),"check-strictly":"",props:{key:"categoryId",label:"name"},"node-key":"id","render-after-expand":!1},null,8,["modelValue","data"])]),_:1}),l(i,{label:"价格区间:"},{default:t(()=>[l(s,{style:{width:"150px"},modelValue:u(q),"onUpdate:modelValue":e[2]||(e[2]=a=>y(q)?q.value=a:q=a),placeholder:"请输入最小值"},null,8,["modelValue"]),_("-- "),l(s,{style:{width:"150px"},modelValue:u(O),"onUpdate:modelValue":e[3]||(e[3]=a=>y(O)?O.value=a:O=a),placeholder:"请输入最大值"},null,8,["modelValue"])]),_:1}),l(i,{label:"排序方式:"},{default:t(()=>[l(B,{modelValue:u(L),"onUpdate:modelValue":e[4]||(e[4]=a=>y(L)?L.value=a:L=a),class:"m-2",placeholder:"请选择排序方式"},{default:t(()=>[l(k,{label:"发布时间",value:"1"}),l(k,{label:"销量",value:"2"}),l(k,{label:"点击数",value:"3"}),l(k,{label:"价格低->高",value:"4"}),l(k,{label:"价格高->低",value:"5"})]),_:1},8,["modelValue"])]),_:1}),l(i,null,{default:t(()=>[l(m,{type:"primary",size:"default",onClick:Ge,disabled:!(u(P)||u(E)||u(L)||u(q)||u(O))},{default:t(()=>[_(" 搜索 ")]),_:1},8,["disabled"]),l(m,{size:"default",onClick:Be},{default:t(()=>[_("重置")]),_:1})]),_:1})]),_:1})]),_:1}),l(M,null,{default:t(()=>[l(m,{type:"success",size:"default",onClick:Ce},{default:t(()=>[_(" 添加 ")]),_:1}),l(m,{type:"danger",size:"default",onClick:he,disabled:!u(ae).length},{default:t(()=>[_(" 批量删除 ")]),_:1},8,["disabled"]),l(f,{border:"",data:u(Q),onSelectionChange:ke,style:{margin:"15px 0"}},{default:t(()=>[l(p,{type:"selection",align:"center",width:"40px"}),l(p,{label:"id",align:"center",prop:"id",width:"50px"}),l(p,{label:"商品封面",align:"center",prop:"pic","show-overflow-tooltip":"",width:"120px"},{default:t(({row:a})=>[I("img",{src:a.pic,alt:"商品封面",style:{width:"100px",height:"auto"}},null,8,Ul)]),_:1}),l(p,{label:"商品名称",align:"center",prop:"name","show-overflow-tooltip":""}),l(p,{label:"货号",align:"center",width:"150px",prop:"productSn","show-overflow-tooltip":""}),l(p,{label:"商品描述",align:"center",prop:"desc","show-overflow-tooltip":""}),l(p,{label:"价格",align:"center",width:"100px",prop:"price","show-overflow-tooltip":""}),l(p,{label:"市场价",align:"center",width:"100px",prop:"originalPrice","show-overflow-tooltip":""}),l(p,{label:"操作",width:"250px",align:"center"},{default:t(({row:a})=>[l(m,{type:"primary",size:"small",icon:"Edit",onClick:g=>Se(a)},{default:t(()=>[_(" 编辑 ")]),_:2},1032,["onClick"]),l(X,{title:`你确定删除${a.name}`,width:"260px",onConfirm:g=>Ie(a.id)},{reference:t(()=>[l(m,{type:"danger",size:"small",icon:"Delete"},{default:t(()=>[_(" 删除 ")]),_:1})]),_:2},1032,["title","onConfirm"]),l(m,{type:"primary",size:"small",icon:"Edit",onClick:g=>u(ve)(a.id)},{default:t(()=>[_(" 查看 ")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"]),l(Ke,{"current-page":u(V),"onUpdate:currentPage":e[5]||(e[5]=a=>y(V)?V.value=a:V=a),"page-size":u(K),"onUpdate:pageSize":e[6]||(e[6]=a=>y(K)?K.value=a:K=a),"page-sizes":[5,10,15,20],background:!0,layout:"prev, pager, next, jumper, -> , sizes, total",total:u(ue),onCurrentChange:S,onSizeChange:Ue},null,8,["current-page","page-size","total"])]),_:1}),l(N,{modelValue:u(x),"onUpdate:modelValue":e[18]||(e[18]=a=>y(x)?x.value=a:x=a),title:o.id?"更新":"添加"},{footer:t(()=>[I("div",Al,[l(m,{onClick:we},{default:t(()=>[_("取消")]),_:1}),l(m,{type:"primary",onClick:xe},{default:t(()=>[_("确定")]),_:1})])]),default:t(()=>[l(h,{model:o,ref_key:"formRef",ref:re},{default:t(()=>[l(i,{label:"名称",prop:"name"},{default:t(()=>[l(s,{placeholder:"请您输入名称",modelValue:o.name,"onUpdate:modelValue":e[7]||(e[7]=a=>o.name=a)},null,8,["modelValue"])]),_:1}),l(i,{label:"所属分类"},{default:t(()=>[l(R,{modelValue:o.categoryId,"onUpdate:modelValue":e[8]||(e[8]=a=>o.categoryId=a),data:u(le),"check-strictly":"",props:{key:"categoryId",label:"name"},"node-key":"id","render-after-expand":!1},null,8,["modelValue","data"])]),_:1}),l(i,{label:"所属属性分类"},{default:t(()=>[l(R,{modelValue:o.attributeCategoryID,"onUpdate:modelValue":e[9]||(e[9]=a=>o.attributeCategoryID=a),data:u(se),"check-strictly":"",props:{key:"attributeCategoryID",label:"name"},"node-key":"id","render-after-expand":!1,onChange:u(Re)},null,8,["modelValue","data","onChange"])]),_:1}),l(i,{label:"货号",prop:"productSn"},{default:t(()=>[l(s,{placeholder:"请您输入货号",modelValue:o.productSn,"onUpdate:modelValue":e[10]||(e[10]=a=>o.productSn=a)},null,8,["modelValue"])]),_:1}),l(i,{label:"商品描述",prop:"desc"},{default:t(()=>[l(s,{placeholder:"商品描述",modelValue:o.desc,"onUpdate:modelValue":e[11]||(e[11]=a=>o.desc=a)},null,8,["modelValue"])]),_:1}),l(i,{label:"市场价",prop:"originalPrice"},{default:t(()=>[l(s,{placeholder:"市场价",modelValue:o.originalPrice,"onUpdate:modelValue":e[12]||(e[12]=a=>o.originalPrice=a)},null,8,["modelValue"])]),_:1}),l(i,{label:"价格",prop:"price"},{default:t(()=>[l(s,{placeholder:"价格",modelValue:o.price,"onUpdate:modelValue":e[13]||(e[13]=a=>o.price=a)},null,8,["modelValue"])]),_:1}),l(i,{label:"商品封面",prop:"pic"},{default:t(()=>[l($,{class:"avatar-uploader",action:"/api/api/sys/upload","show-file-list":!1,"on-success":me,"before-upload":fe},{default:t(()=>[o.pic?(c(),C("img",{key:0,src:o.pic,class:"avatar"},null,8,kl)):(c(),A(Z,{key:1,class:"avatar-uploader-icon"},{default:t(()=>[l(Y)]),_:1}))]),_:1})]),_:1})]),_:1},8,["model"]),l(h,{model:o,inline:!0},{default:t(()=>[hl,l($,{"file-list":j.value,"onUpdate:fileList":e[14]||(e[14]=a=>j.value=a),action:"/api/api/sys/upload","list-type":"picture-card","on-preview":Ae,"on-remove":Ee,"on-success":Te},{default:t(()=>[l(Z,null,{default:t(()=>[l(Y)]),_:1})]),_:1},8,["file-list"]),l(N,{modelValue:te.value,"onUpdate:modelValue":e[15]||(e[15]=a=>te.value=a)},{default:t(()=>[I("img",{"w-full":"",src:pe.value,alt:"Preview Image"},null,8,Il)]),_:1},8,["modelValue"])]),_:1},8,["model"]),l(h,{model:o,inline:!0},{default:t(()=>[wl,l($,{"file-list":F.value,"onUpdate:fileList":e[16]||(e[16]=a=>F.value=a),action:"/api/api/sys/upload","list-type":"picture-card","on-preview":Pe,"on-remove":ze,"on-success":De},{default:t(()=>[l(Z,null,{default:t(()=>[l(Y)]),_:1})]),_:1},8,["file-list"]),l(N,{modelValue:oe.value,"onUpdate:modelValue":e[17]||(e[17]=a=>oe.value=a)},{default:t(()=>[I("img",{"w-full":"",src:ce.value,alt:"Preview Image"},null,8,Cl)]),_:1},8,["modelValue"])]),_:1},8,["model"]),l(h,{model:o,inline:!0},{default:t(()=>[Sl,(c(!0),C(D,null,G(o.attributeType1,(a,g)=>(c(),A(i,{prop:"attrList",key:g,label:a.name},{default:t(()=>[l(B,{modelValue:u(U)[g],"onUpdate:modelValue":v=>u(U)[g]=v,placeholder:"请选择"},{default:t(()=>[(c(!0),C(D,null,G(u(ne)(a.value),(v,H)=>(c(),A(k,{key:H,label:v,value:v},null,8,["label","value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue"])]),_:2},1032,["label"]))),128))]),_:1},8,["model"]),l(h,{model:o,inline:!0},{default:t(()=>[xl,(c(!0),C(D,null,G(o.attributeType2,(a,g)=>(c(),A(Fe,{modelValue:u(w)[g],"onUpdate:modelValue":v=>u(w)[g]=v,label:a.name},{default:t(()=>[(c(!0),C(D,null,G(u(ne)(a.value),(v,H)=>(c(),A(je,{label:v,key:H,value:v},null,8,["label","value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue","label"]))),256))]),_:1},8,["model"])]),_:1},8,["modelValue","title"]),l(N,{modelValue:u(z),"onUpdate:modelValue":e[20]||(e[20]=a=>y(z)?z.value=a:z=a),title:"SKU列表",width:"70%"},{default:t(()=>[l(f,{data:u(ge),modelValue:u(d),"onUpdate:modelValue":e[19]||(e[19]=a=>y(d)?d.value=a:d=a)},{default:t(()=>[l(p,{label:"SKU图片"},{default:t(({row:a})=>[I("img",{src:a.pic,alt:"",style:{width:"100px",height:"100px"}},null,8,Pl)]),_:1}),l(p,{label:"sku编号",width:"120px",prop:"skuSn"}),l(p,{label:"SKU名字",prop:"name"}),l(p,{label:"SKU价格",width:"80px",prop:"price"}),l(p,{label:"库存",width:"80px",prop:"stock"}),l(p,{label:"销量",width:"80px",prop:"sale"}),l(p,{label:"TAG",prop:"tag"}),l(p,{label:"描述",prop:"description"}),l(p,{label:"操作",width:"100px",align:"center"},{default:t(({row:a})=>[l(m,{type:"primary",size:"small",icon:"Edit",onClick:g=>Le(a)},{default:t(()=>[_(" 编辑 ")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data","modelValue"])]),_:1},8,["modelValue"]),l(N,{modelValue:u(T),"onUpdate:modelValue":e[26]||(e[26]=a=>y(T)?T.value=a:T=a),title:"SKU",width:"70%"},{footer:t(()=>[I("div",zl,[l(m,{onClick:qe},{default:t(()=>[_("取消")]),_:1}),l(m,{type:"primary",onClick:Oe},{default:t(()=>[_("确定")]),_:1})])]),default:t(()=>[l(h,{model:u(d),ref_key:"formRef",ref:re},{default:t(()=>[l(i,{label:"名称",prop:"name"},{default:t(()=>[l(s,{placeholder:"请您输入名称",modelValue:u(d).name,"onUpdate:modelValue":e[21]||(e[21]=a=>u(d).name=a)},null,8,["modelValue"])]),_:1}),l(i,{label:"sku编号",prop:"skuSn"},{default:t(()=>[l(s,{placeholder:"请您输入",modelValue:u(d).skuSn,"onUpdate:modelValue":e[22]||(e[22]=a=>u(d).skuSn=a)},null,8,["modelValue"])]),_:1}),l(i,{label:"商品描述",prop:"description"},{default:t(()=>[l(s,{placeholder:"商品描述",modelValue:u(d).description,"onUpdate:modelValue":e[23]||(e[23]=a=>u(d).description=a)},null,8,["modelValue"])]),_:1}),l(i,{label:"库存",prop:"stock"},{default:t(()=>[l(s,{placeholder:"库存",modelValue:u(d).stock,"onUpdate:modelValue":e[24]||(e[24]=a=>u(d).stock=a),modelModifiers:{number:!0}},null,8,["modelValue"])]),_:1}),l(i,{label:"价格",prop:"price"},{default:t(()=>[l(s,{placeholder:"价格",modelValue:u(d).price,"onUpdate:modelValue":e[25]||(e[25]=a=>u(d).price=a)},null,8,["modelValue"])]),_:1}),(c(!0),C(D,null,G(u(d).sizeList,(a,g)=>(c(),A(i,{label:a.name,prop:`sizeList${g}`},{default:t(()=>[l(B,{modelValue:u(d).AttributeShopValueID[g],"onUpdate:modelValue":v=>u(d).AttributeShopValueID[g]=v,placeholder:"请选择属性"},{default:t(()=>[(c(!0),C(D,null,G(a.sizeValueList,(v,H)=>(c(),A(k,{key:H,label:v.name,value:v.id},null,8,["label","value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue"])]),_:2},1032,["label","prop"]))),256)),l(i,{label:"商品封面",prop:"pic"},{default:t(()=>[l($,{class:"avatar-uploader",action:"/api/api/sys/upload","show-file-list":!1,"on-success":me,"before-upload":fe},{default:t(()=>[u(d).pic?(c(),C("img",{key:0,src:u(d).pic,class:"avatar"},null,8,El)):(c(),A(Z,{key:1,class:"avatar-uploader-icon"},{default:t(()=>[l(Y)]),_:1}))]),_:1})]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])],64)}}});const aa=Vl(Tl,[["__scopeId","data-v-261f7c31"]]);export{aa as default};
