/* empty css             *//* empty css                       *//* empty css                  *//* empty css                             *//* empty css                      *//* empty css                 *//* empty css               *//* empty css                  *//* empty css                  *//* empty css                        *//* empty css                *//* empty css                     */import{at as B,d as ne,a as r,aa as ue,a7 as I,b as ie,o as v,c as pe,e,w as l,f as s,M as y,h as n,t as k,x as p,C,z as E,F as de,aj as ce,ak as me,m as fe,n as _e,p as ge,a5 as be,al as ve,ah as ye,an as he,ao as we,ad as xe,ae as ke,ap as Ce,aC as Ee,a9 as ze}from"./index-bc94ad6c.js";import{u as Ve}from"./setting-343fd123.js";const Se=(_,z,N)=>B.get("/api/oms/ReturnApply/list",{params:{current:_,pageSize:z,status:N}}),Ae=_=>_.id?B.post("/api/oms/ReturnApply/update",_):B.post("/api/oms/ReturnApply/add",_),Re={style:{color:"red"}},Ie=["src"],Ne={style:{color:"red"}},Ue={style:{color:"red"}},Be=["src"],Qe=ne({__name:"index",setup(_){let z=Ve();const N=r("");let g=r(1),h=r(10),D=r(0),T=r([]),F=r([]),i=r([]),G=r(""),m=r(""),H=r([]);const J=a=>{H.value=a};let w=r(!1),b=r(!1);ue(()=>{x()});const x=async(a=1)=>{g.value=a;let o=await Se(g.value,h.value,m.value);o.code==200?(D.value=o.total,T.value=o.data,I({type:"success",message:o.message})):I({type:"error",message:o.message})},Z=()=>{x()};let K=async a=>{w.value=!0,F.value=a.order.skuList,i.value=a},P=r(null),d=r(null),Q=async a=>{P.value=a.id,b.value=!0,a.status=="0"?d.value="待处理":a.status=="1"?d.value="允许退货":a.status=="2"?d.value="完成退货":a.status=="3"&&(d.value="拒绝退货")},W=async()=>{let a={id:P.value,status:X(d.value)},o=await Ae(a);o.code===200?(x(),b.value=!1,I({type:"success",message:o.message})):I({type:"error",message:o.message})};function X(a){const f=[{label:"待处理",value:"0"},{label:"允许退货",value:"1"},{label:"完成退货",value:"2"},{label:"拒绝退货",value:"3"}].find(U=>U.label===a);return f?f.value:a}const Y=()=>{x(),m.value="",G.value=""},$=()=>{z.refresh=!z.refresh};let V=ie(),ee=r(!1),q=r(!1),le=r(!1);for(let a=0;a<V.roles.length;a++)V.roles[a].includes("商家")&&(ee.value=!0),V.roles[a].includes("自提点")&&(q.value=!0),V.roles[a].includes("超级管理员")&&(le.value=!0);return(a,o)=>{const f=ce,U=me,L=fe,S=_e,te=ge,M=be,u=ve,A=ye,j=he,ae=we,c=xe,oe=ke,O=Ce,R=Ee,se=ze;return v(),pe(de,null,[e(M,null,{default:l(()=>[e(te,{inline:!0},{default:l(()=>[e(L,{label:"状态:"},{default:l(()=>[e(U,{modelValue:s(m),"onUpdate:modelValue":o[0]||(o[0]=t=>y(m)?m.value=t:m=t),class:"m-2",placeholder:"请选择状态"},{default:l(()=>[e(f,{label:"待处理",value:"0"}),e(f,{label:"退货中",value:"1"}),e(f,{label:"已完成",value:"2"}),e(f,{label:"已拒绝",value:"3"})]),_:1},8,["modelValue"])]),_:1}),e(L,null,{default:l(()=>[e(S,{type:"primary",size:"default",onClick:Y,disabled:!s(m).length},{default:l(()=>[n(" 搜索 ")]),_:1},8,["disabled"]),e(S,{size:"default",onClick:$},{default:l(()=>[n("重置")]),_:1})]),_:1})]),_:1})]),_:1}),e(M,null,{default:l(()=>[e(j,{border:"",data:s(T),onSelectionChange:J,style:{margin:"15px 0"}},{default:l(()=>[e(u,{type:"selection",align:"center",width:"40px"}),e(u,{label:"id",align:"center",prop:"id",width:"50px"}),e(u,{label:"订单号",align:"center",prop:"order.orderInfo.orderSn","show-overflow-tooltip":""}),e(u,{label:"退款金额",align:"center",prop:"returnAmount","show-overflow-tooltip":""},{default:l(({row:t})=>[k("p",Re,"¥"+p(t.returnAmount),1)]),_:1}),e(u,{label:"退货原因",align:"center",prop:"returnReasonName","show-overflow-tooltip":""}),e(u,{label:"用户名",align:"center",prop:"user.username","show-overflow-tooltip":""}),e(u,{label:"状态",align:"center",prop:"status","show-overflow-tooltip":""},{default:l(({row:t})=>[t.status==="0"?(v(),C(A,{key:"item.label",class:"mx-1",type:"danger",effect:"light"},{default:l(()=>[n(" 待处理 ")]),_:1})):E("",!0),t.status==="1"?(v(),C(A,{key:"item.label",class:"mx-1",type:"success",effect:"light"},{default:l(()=>[n(" 退货中 ")]),_:1})):E("",!0),t.status==="2"?(v(),C(A,{key:"item.label",class:"mx-1",type:"success",effect:"light"},{default:l(()=>[n(" 已完成 ")]),_:1})):E("",!0),t.status==="3"?(v(),C(A,{key:"item.label",class:"mx-1",type:"success",effect:"light"},{default:l(()=>[n(" 已拒绝 ")]),_:1})):E("",!0)]),_:1}),e(u,{label:"操作",width:"300px",align:"center"},{default:l(({row:t})=>[e(S,{type:"primary",size:"small",icon:"Edit",onClick:re=>s(K)(t)},{default:l(()=>[n(" 查看详情 ")]),_:2},1032,["onClick"]),s(q)?E("",!0):(v(),C(S,{key:0,type:"danger",size:"small",icon:"Edit",onClick:re=>s(Q)(t)},{default:l(()=>[n(" 退货处理 ")]),_:2},1032,["onClick"]))]),_:1})]),_:1},8,["data"]),e(ae,{"current-page":s(g),"onUpdate:currentPage":o[1]||(o[1]=t=>y(g)?g.value=t:g=t),"page-size":s(h),"onUpdate:pageSize":o[2]||(o[2]=t=>y(h)?h.value=t:h=t),"page-sizes":[5,10,15,20],background:!0,layout:"prev, pager, next, jumper, -> , sizes, total",total:s(D),onCurrentChange:x,onSizeChange:Z},null,8,["current-page","page-size","total"])]),_:1}),e(O,{modelValue:s(w),"onUpdate:modelValue":o[3]||(o[3]=t=>y(w)?w.value=t:w=t),title:"订单详情",width:"70%"},{default:l(()=>[e(j,{data:s(F)},{default:l(()=>[e(u,{label:"商品图片",align:"center",prop:"pic","show-overflow-tooltip":"",width:"120px"},{default:l(({row:t})=>[k("img",{src:t.pic,alt:"商品图片",style:{width:"100px",height:"auto"}},null,8,Ie)]),_:1}),e(u,{label:"货号",align:"center",prop:"skuSn","show-overflow-tooltip":""}),e(u,{label:"商品名称",align:"center",prop:"productName","show-overflow-tooltip":""}),e(u,{label:"规格",align:"center",prop:"tag","show-overflow-tooltip":"",width:"300px"}),e(u,{label:"价格",align:"center",prop:"price","show-overflow-tooltip":""},{default:l(({row:t})=>[k("p",Ne,"¥"+p(t.price),1)]),_:1})]),_:1},8,["data"]),e(oe,{title:"服务单信息",direction:"horizontal",column:1,size:N.value,border:"",style:{margin:"40px 0 0 20px"}},{default:l(()=>[e(c,{label:"订单号"},{default:l(()=>[n(p(s(i).order.orderInfo.orderSn),1)]),_:1}),e(c,{label:"用户账号"},{default:l(()=>[n(p(s(i).user.username),1)]),_:1}),e(c,{label:"联系人"},{default:l(()=>[n(p(s(i).order.orderInfo.receiverName),1)]),_:1}),e(c,{label:"联系电话"},{default:l(()=>[n(p(s(i).order.orderInfo.receiverPhone),1)]),_:1}),e(c,{label:"退货原因"},{default:l(()=>[n(p(s(i).returnReasonName),1)]),_:1}),e(c,{label:"问题描述"},{default:l(()=>[n(p(s(i).description),1)]),_:1}),e(c,{label:"订单金额"},{default:l(()=>[n(p(s(i).order.orderInfo.payAmount),1)]),_:1}),e(c,{label:"退货金额"},{default:l(()=>[k("p",Ue,"¥"+p(s(i).returnAmount),1)]),_:1}),e(c,{label:"凭证图片"},{default:l(()=>[k("img",{src:s(i).proofPics,alt:"",style:{width:"400px"}},null,8,Be)]),_:1})]),_:1},8,["size"])]),_:1},8,["modelValue"]),e(O,{modelValue:s(b),"onUpdate:modelValue":o[5]||(o[5]=t=>y(b)?b.value=t:b=t),title:"退货处理"},{default:l(()=>[e(se,{modelValue:s(d),"onUpdate:modelValue":o[4]||(o[4]=t=>y(d)?d.value=t:d=t),size:"large",onChange:s(W)},{default:l(()=>[e(R,{label:"待处理",disabled:"true"}),e(R,{label:"允许退货"}),e(R,{label:"完成退货"}),e(R,{label:"拒绝退货"})]),_:1},8,["modelValue","onChange"])]),_:1},8,["modelValue"])],64)}}});export{Qe as default};
