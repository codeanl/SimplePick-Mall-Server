/* empty css             *//* empty css                  *//* empty css                  *//* empty css                          *//* empty css                        *//* empty css                      *//* empty css                 *//* empty css               *//* empty css                  *//* empty css                  *//* empty css                      *//* empty css                   *//* empty css                  *//* empty css                *//* empty css                     */import{b as ye,r as J,c as we,d as ke,R as Ce,e as Q,f as Ue}from"./index-66e03b3b.js";import{u as xe}from"./setting-343fd123.js";import{d as Ee,a as u,r as ze,aa as qe,a7 as m,o as q,c as W,e,w as t,f as o,M as g,h as d,t as A,C as P,F as X,B as Se,x as Re,K as Y,k as Be,m as De,aj as Ie,ak as Pe,n as Ae,p as je,a5 as Ne,al as Oe,ah as Te,P as Fe,am as Me,an as Le,ao as Ge,ap as He,aq as Ke,ar as Je,as as Qe}from"./index-bc94ad6c.js";const We=["src"],Xe={style:{flex:"auto"}},Ye=A("h4",null,"分配角色",-1),Ze={style:{flex:"auto"}},Vl=Ee({__name:"index",setup($e){let v=u(1),S=u(10),M=u(0),y=u(""),w=u(""),z=u(""),k=u(""),C=u(""),U=u(""),r=ze({username:"",nickname:"",phone:"",email:"",status:"",gender:""}),c=u();const j=u(!1),N=u(!0);let R=u([]),x=u([]),O=u([]),B=u([]),L=xe();qe(()=>{E()});let D=u([]);const E=async(s=1)=>{v.value=s;let l=await ye(v.value,S.value,y.value,z.value,w.value,C.value,U.value,k.value);l.code==200?(M.value=l.total,D.value=l.data,m({type:"success",message:l.message})):m({type:"error",message:l.message})},Z=()=>{E()};let V=u(!1),b=u(!1);const $=()=>{V.value=!0,Object.assign(r,{id:0,username:"",nickname:"",phone:"",email:"",status:"1",gender:""}),Y(()=>{c.value.clearValidate("username"),c.value.clearValidate("nicknem"),c.value.clearValidate("phone"),c.value.clearValidate("status"),c.value.clearValidate("gender")})},ee=s=>{V.value=!0,Object.assign(r,s),Y(()=>{c.value.clearValidate("username"),c.value.clearValidate("nicknem"),c.value.clearValidate("phone"),c.value.clearValidate("status"),c.value.clearValidate("gender")})},le={username:[{required:!0,trigger:"blur"}],nickname:[{required:!0,trigger:"blur"}],phone:[{required:!0,trigger:"blur"}],gender:[{required:!0,trigger:"blur"}],status:[{required:!0,trigger:"blur"}]},ae=async()=>{await c.value.validate();let s=await J(r);s.code==200?(V.value=!1,m({type:"success",message:s.message}),window.location.reload()):(V.value=!1,m({type:"error",message:s.message}))},te=()=>{V.value=!1},oe=async s=>{b.value=!0,Object.assign(r,s);let l=await we();l.code===200&&(R.value=l.data);let n=await ke({userID:r.id});n.code===200&&(x.value=n.data)},se=s=>{x.value=s?R.value:[],N.value=!1},ne=s=>{const l=s.length;j.value=l===R.value.length,N.value=l>0&&l<R.value.length},re=async()=>{let s={id:r.id,roleId:x.value.map(n=>n.id)},l=await Ce(s);l.code===200?(b.value=!1,E(v.value),m({type:"success",message:l.message})):m({type:"error",message:l.message})},ue=async s=>{B.value.push(s);const l={ids:B.value};let n=await Q(l);n.code==200?(E(D.value.length>1?v.value:v.value-1),m({type:"success",message:n.message})):m({type:"error",message:n.message})},de=s=>{O.value=s},ie=async()=>{B.value=O.value.map(n=>n.id);const s={ids:B.value};let l=await Q(s);l.code===200?(E(D.value.length>1?v.value:v.value-1),m({type:"success",message:l.message})):m({type:"error",message:l.message})},me=()=>{E(),y.value="",w.value="",k.value="",C.value="",U.value=""},pe=()=>{L.refresh=!L.refresh};let ce=async s=>{let l={id:s.id,status:s.status},n=await J(l);n.code===200?m({type:"success",message:n.message}):m({type:"error",message:n.message})},fe=async s=>{let l=await Ue({id:s});l.code===200&&(l.code===200?m({type:"success",message:l.message}):m({type:"error",message:l.message}))};return(s,l)=>{const n=Be,i=De,_=Ie,I=Pe,f=Ae,T=je,G=Ne,p=Oe,F=Te,ge=Fe,H=Me,ve=Le,_e=Ge,Ve=He,K=Ke,be=Je,he=Qe;return q(),W(X,null,[e(G,null,{default:t(()=>[e(T,{inline:!0},{default:t(()=>[e(i,{label:"用户名:"},{default:t(()=>[e(n,{placeholder:"请输入搜索的用户名",modelValue:o(y),"onUpdate:modelValue":l[0]||(l[0]=a=>g(y)?y.value=a:y=a)},null,8,["modelValue"])]),_:1}),e(i,{label:"昵称:"},{default:t(()=>[e(n,{placeholder:"请输入搜索的昵称",modelValue:o(w),"onUpdate:modelValue":l[1]||(l[1]=a=>g(w)?w.value=a:w=a)},null,8,["modelValue"])]),_:1}),e(i,{label:"手机号:"},{default:t(()=>[e(n,{placeholder:"请输入搜索的手机号",modelValue:o(z),"onUpdate:modelValue":l[2]||(l[2]=a=>g(z)?z.value=a:z=a)},null,8,["modelValue"])]),_:1}),e(i,{label:"邮箱:"},{default:t(()=>[e(n,{placeholder:"请输入搜索的邮箱",modelValue:o(k),"onUpdate:modelValue":l[3]||(l[3]=a=>g(k)?k.value=a:k=a)},null,8,["modelValue"])]),_:1}),e(i,{label:"性别:"},{default:t(()=>[e(I,{modelValue:o(U),"onUpdate:modelValue":l[4]||(l[4]=a=>g(U)?U.value=a:U=a),class:"m-2",placeholder:"请选择性别"},{default:t(()=>[e(_,{label:"保密",value:"0"}),e(_,{label:"男",value:"1"}),e(_,{label:"女",value:"2"})]),_:1},8,["modelValue"])]),_:1}),e(i,{label:"状态:"},{default:t(()=>[e(I,{modelValue:o(C),"onUpdate:modelValue":l[5]||(l[5]=a=>g(C)?C.value=a:C=a),class:"m-2",placeholder:"请选择状态"},{default:t(()=>[e(_,{label:"正常",value:"1"}),e(_,{label:"禁用",value:"0"})]),_:1},8,["modelValue"])]),_:1}),e(i,null,{default:t(()=>[e(f,{type:"primary",size:"default",onClick:me,disabled:!(o(k).length||o(y).length||o(w).length||o(z).length||o(U).length||o(C).length)},{default:t(()=>[d(" 搜索 ")]),_:1},8,["disabled"]),e(f,{size:"default",onClick:pe},{default:t(()=>[d("重置")]),_:1})]),_:1})]),_:1})]),_:1}),e(G,null,{default:t(()=>[e(f,{type:"success",size:"default",onClick:$},{default:t(()=>[d(" 添加 ")]),_:1}),e(f,{type:"danger",size:"default",onClick:ie,disabled:!o(O).length},{default:t(()=>[d(" 批量删除 ")]),_:1},8,["disabled"]),e(ve,{border:"",data:o(D),onSelectionChange:de,style:{margin:"15px 0"}},{default:t(()=>[e(p,{type:"selection",align:"center",width:"40px"}),e(p,{label:"id",align:"center",prop:"id",width:"50px"}),e(p,{label:"头像",align:"center",prop:"avatar","show-overflow-tooltip":"",width:"60px"},{default:t(({row:a})=>[A("img",{src:a.avatar,alt:"头像",style:{width:"40px",height:"40px","border-radius":"50%"}},null,8,We)]),_:1}),e(p,{label:"用户名字",align:"center",prop:"username","show-overflow-tooltip":""}),e(p,{label:"用户昵称",align:"center",prop:"nickname","show-overflow-tooltip":""}),e(p,{label:"性别",align:"center",prop:"gender","show-overflow-tooltip":"",width:"70px"},{default:t(({row:a})=>[a.gender==="0"?(q(),P(F,{key:0,type:"warning"},{default:t(()=>[d("保密")]),_:1})):a.gender==="1"?(q(),P(F,{key:1,type:"primary"},{default:t(()=>[d("男")]),_:1})):(q(),P(F,{key:2,type:"success"},{default:t(()=>[d("女 ")]),_:1}))]),_:1}),e(p,{label:"邮箱",align:"center",prop:"email","show-overflow-tooltip":""}),e(p,{label:"手机号",align:"center",prop:"phone","show-overflow-tooltip":""}),e(p,{label:"用户角色",align:"center",prop:"roleName","show-overflow-tooltip":""}),e(p,{label:"创建时间",align:"center",prop:"creat_at","show-overflow-tooltip":""}),e(p,{label:"更新时间",align:"center",prop:"update_at","show-overflow-tooltip":""}),e(p,{label:"状态",align:"center",prop:"status","show-overflow-tooltip":"",width:"60px"},{default:t(({row:a})=>[e(ge,{modelValue:a.status,"onUpdate:modelValue":h=>a.status=h,class:"ml-2",style:{"--el-switch-on-color":"#13ce66","--el-switch-off-color":"#f06455"},"active-value":"1","inactive-value":"0",onChange:h=>o(ce)(a)},null,8,["modelValue","onUpdate:modelValue","onChange"])]),_:1}),e(p,{label:"操作",width:"400px",align:"center"},{default:t(({row:a})=>[e(f,{type:"success",size:"small",icon:"User",onClick:h=>oe(a)},{default:t(()=>[d(" 角色 ")]),_:2},1032,["onClick"]),e(H,{title:`你确定要重置${a.username}的密码吗？`,width:"260px",onConfirm:h=>o(fe)(a.id)},{reference:t(()=>[e(f,{type:"warning",size:"small",icon:"Star"},{default:t(()=>[d(" 重置 ")]),_:1})]),_:2},1032,["title","onConfirm"]),e(f,{type:"primary",size:"small",icon:"Edit",onClick:h=>ee(a)},{default:t(()=>[d(" 编辑 ")]),_:2},1032,["onClick"]),e(H,{title:`你确定删除${a.username}`,width:"260px",onConfirm:h=>ue(a.id)},{reference:t(()=>[e(f,{type:"danger",size:"small",icon:"Delete"},{default:t(()=>[d(" 删除 ")]),_:1})]),_:2},1032,["title","onConfirm"])]),_:1})]),_:1},8,["data"]),e(_e,{"current-page":o(v),"onUpdate:currentPage":l[6]||(l[6]=a=>g(v)?v.value=a:v=a),"page-size":o(S),"onUpdate:pageSize":l[7]||(l[7]=a=>g(S)?S.value=a:S=a),"page-sizes":[5,10,15,20],background:!0,layout:"prev, pager, next, jumper, -> , sizes, total",total:o(M),onCurrentChange:E,onSizeChange:Z},null,8,["current-page","page-size","total"])]),_:1}),e(Ve,{modelValue:o(V),"onUpdate:modelValue":l[14]||(l[14]=a=>g(V)?V.value=a:V=a),title:o(r).id?"更新":"添加"},{footer:t(()=>[A("div",Xe,[e(f,{onClick:te},{default:t(()=>[d("取消")]),_:1}),e(f,{type:"primary",onClick:ae},{default:t(()=>[d("确定")]),_:1})])]),default:t(()=>[e(T,{model:o(r),rules:le,ref_key:"formRef",ref:c},{default:t(()=>[e(i,{label:"用户名",prop:"username"},{default:t(()=>[e(n,{placeholder:"请您输入用户名",modelValue:o(r).username,"onUpdate:modelValue":l[8]||(l[8]=a=>o(r).username=a)},null,8,["modelValue"])]),_:1}),e(i,{label:"昵称",prop:"nickname"},{default:t(()=>[e(n,{placeholder:"请您输入昵称",modelValue:o(r).nickname,"onUpdate:modelValue":l[9]||(l[9]=a=>o(r).nickname=a)},null,8,["modelValue"])]),_:1}),e(i,{label:"手机号",prop:"phone"},{default:t(()=>[e(n,{placeholder:"请您输入手机号",modelValue:o(r).phone,"onUpdate:modelValue":l[10]||(l[10]=a=>o(r).phone=a)},null,8,["modelValue"])]),_:1}),e(i,{label:"邮箱",prop:"email"},{default:t(()=>[e(n,{placeholder:"请您输入邮箱",modelValue:o(r).email,"onUpdate:modelValue":l[11]||(l[11]=a=>o(r).email=a)},null,8,["modelValue"])]),_:1}),e(i,{label:"性别",prop:"gender"},{default:t(()=>[e(I,{modelValue:o(r).gender,"onUpdate:modelValue":l[12]||(l[12]=a=>o(r).gender=a),class:"m-2",placeholder:"请选择性别"},{default:t(()=>[e(_,{label:"保密",value:"0"}),e(_,{label:"男",value:"1"}),e(_,{label:"女",value:"2"})]),_:1},8,["modelValue"])]),_:1}),e(i,{label:"状态",prop:"status"},{default:t(()=>[e(I,{modelValue:o(r).status,"onUpdate:modelValue":l[13]||(l[13]=a=>o(r).status=a),class:"m-2",placeholder:"请选择状态"},{default:t(()=>[e(_,{label:"正常",value:"1"}),e(_,{label:"禁用",value:"0"})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"]),e(he,{modelValue:o(b),"onUpdate:modelValue":l[19]||(l[19]=a=>g(b)?b.value=a:b=a)},{header:t(()=>[Ye]),default:t(()=>[e(T,null,{default:t(()=>[e(i,{label:"用户姓名"},{default:t(()=>[e(n,{modelValue:o(r).username,"onUpdate:modelValue":l[15]||(l[15]=a=>o(r).username=a),disabled:!0},null,8,["modelValue"])]),_:1}),e(i,{label:"职位列表"},{default:t(()=>[e(K,{modelValue:j.value,"onUpdate:modelValue":l[16]||(l[16]=a=>j.value=a),indeterminate:N.value,onChange:se},{default:t(()=>[d(" 全选 ")]),_:1},8,["modelValue","indeterminate"]),e(be,{modelValue:o(x),"onUpdate:modelValue":l[17]||(l[17]=a=>g(x)?x.value=a:x=a),onChange:ne},{default:t(()=>[(q(!0),W(X,null,Se(o(R),(a,h)=>(q(),P(K,{key:h,label:a},{default:t(()=>[d(Re(a.name),1)]),_:2},1032,["label"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1})]),footer:t(()=>[A("div",Ze,[e(f,{onClick:l[18]||(l[18]=a=>g(b)?b.value=!1:b=!1)},{default:t(()=>[d("取消")]),_:1}),e(f,{type:"primary",onClick:re},{default:t(()=>[d("确定")]),_:1})])]),_:1},8,["modelValue"])],64)}}});export{Vl as default};
