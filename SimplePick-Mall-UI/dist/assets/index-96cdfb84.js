/* empty css             *//* empty css                  *//* empty css                    *//* empty css                *//* empty css                      *//* empty css                 *//* empty css               *//* empty css                  *//* empty css                  *//* empty css                        *//* empty css                      *//* empty css                   *//* empty css                  *//* empty css                *//* empty css                     */import{at as j,d as we,a as u,r as he,aa as Ce,a7 as i,A as ke,o as S,c as Y,e,w as t,f as o,M as f,h as c,t as Z,C as N,F as Ue,K as $,k as xe,m as ze,aj as Ee,ak as Le,n as Se,p as je,a5 as Me,al as Pe,ah as qe,P as Ae,am as De,an as Ie,ao as Te,G as Ne,ac as Be,ap as Ge}from"./index-bc94ad6c.js";import{u as Oe}from"./setting-343fd123.js";const Re=(g,m,b,D,x,M,y)=>j.get("/api/ums/member/list",{params:{current:g,pageSize:m,username:b,phone:D,status:x,nickname:M,gender:y}}),ee=g=>g.id?j.post("/api/ums/member/update",g):j.post("/api/ums/member/add",g),le=g=>j.post("/api/ums/member/delete",g),Fe=(g,m,b)=>j.get("/api/ums/MemberLoginLog/list",{params:{current:g,pageSize:m,userId:b}}),He=g=>j.post("/api/ums/MemberLoginLog/delete",g),Je=["src"],Ke=["src"],Qe={style:{flex:"auto"}},ml=we({__name:"index",setup(g){let m=u(1),b=u(10),D=u(0),x=u([]),M=u([]),y=u([]);const ae=s=>{M.value=s};let w=u(),P=u(!1),V=u(!1),n=he({username:"",nickname:"",phone:"",email:"",status:"",gender:"",job:"",city:"",signature:"",avatar:""}),h=u(""),C=u(""),k=u(""),z=u(""),E=u(""),G=Oe();Ce(()=>{U()});const U=async(s=1)=>{m.value=s;let a=await Re(m.value,b.value,h.value,C.value,k.value,z.value,E.value);a.code==200?(D.value=a.total,x.value=a.data,i({type:"success",message:a.message})):i({type:"error",message:a.message})},te=()=>{U()},oe=()=>{U(),h.value="",C.value="",k.value=""},se=()=>{G.refresh=!G.refresh},ne=()=>{V.value=!1},re=()=>{V.value=!0,Object.assign(n,{id:0,username:"",nickname:"",phone:"",email:"",status:"",gender:"",job:"",city:"",signature:"",avatar:""}),n.status="1",$(()=>{w.value.clearValidate("username"),w.value.clearValidate("name"),w.value.clearValidate("password")})},ue=s=>{n.avatar=s.data,w.value.clearValidate("avatar")},de=s=>{if(s.type==="image/png"||s.type==="image/jpeg"||s.type==="image/gif"){if(s.size/1024/1024<4)return!0;i({type:"error",message:"上传的文件大小应小于4M"})}else return i({type:"error",message:"上传的文件类型必须是PNG|JPG|GIF"}),!1},pe=s=>{V.value=!0,Object.assign(n,s),$(()=>{w.value.clearValidate("username"),w.value.clearValidate("name")})},ie=async()=>{await w.value.validate();let s=await ee(n);s.code==200?(V.value=!1,i({type:"success",message:s.message}),U(n.id?m.value:1)):(V.value=!1,i({type:"error",message:s.message}))},me=async s=>{y.value.push(s);const a={ids:y.value};let r=await le(a);r.code==200?(U(x.value.length>1?m.value:m.value-1),i({type:"success",message:r.message})):i({type:"error",message:r.message})},ce=async()=>{y.value=M.value.map(r=>r.id);const s={ids:y.value};let a=await le(s);a.code===200?(U(x.value.length>1?m.value:m.value-1),i({type:"success",message:a.message})):i({type:"error",message:a.message})};let q=u(1),A=u(10),O=u(0),R=u([]),F=u(),ge=s=>{F.value=s,I()},I=async()=>{P.value=!0;let s=await Fe(q.value,A.value,F.value);s.code==200?(O.value=s.total,R.value=s.data,i({type:"success",message:s.message})):i({type:"error",message:s.message})},fe=async s=>{let a={id:s.id,status:s.status},r=await ee(a);r.code==200?i({type:"success",message:r.message}):i({type:"error",message:r.message})};const ve=async s=>{y.value=[],y.value.push(s);const a={ids:y.value};let r=await He(a);r.code==200?(I(),i({type:"success",message:r.message})):i({type:"error",message:r.message})};return(s,a)=>{const r=xe,p=ze,v=Ee,T=Le,_=Se,H=je,J=Me,d=Pe,B=qe,_e=Ae,K=De,Q=Ie,W=Te,be=ke("Plus"),ye=Ne,Ve=Be,X=Ge;return S(),Y(Ue,null,[e(J,null,{default:t(()=>[e(H,{inline:!0},{default:t(()=>[e(p,{label:"用户名:"},{default:t(()=>[e(r,{placeholder:"请输入搜索的用户名",modelValue:o(h),"onUpdate:modelValue":a[0]||(a[0]=l=>f(h)?h.value=l:h=l)},null,8,["modelValue"])]),_:1}),e(p,{label:"手机号:"},{default:t(()=>[e(r,{placeholder:"请输入搜索的手机号",modelValue:o(C),"onUpdate:modelValue":a[1]||(a[1]=l=>f(C)?C.value=l:C=l)},null,8,["modelValue"])]),_:1}),e(p,{label:"昵称:"},{default:t(()=>[e(r,{placeholder:"请输入搜索的昵称",modelValue:o(z),"onUpdate:modelValue":a[2]||(a[2]=l=>f(z)?z.value=l:z=l)},null,8,["modelValue"])]),_:1}),e(p,{label:"状态:"},{default:t(()=>[e(T,{modelValue:o(k),"onUpdate:modelValue":a[3]||(a[3]=l=>f(k)?k.value=l:k=l),class:"m-2",placeholder:"请选择状态"},{default:t(()=>[e(v,{label:"正常",value:"1"}),e(v,{label:"禁用",value:"0"})]),_:1},8,["modelValue"])]),_:1}),e(p,{label:"性别:"},{default:t(()=>[e(T,{modelValue:o(E),"onUpdate:modelValue":a[4]||(a[4]=l=>f(E)?E.value=l:E=l),class:"m-2",placeholder:"请选择性别"},{default:t(()=>[e(v,{label:"保密",value:"0"}),e(v,{label:"男",value:"1"}),e(v,{label:"女",value:"2"})]),_:1},8,["modelValue"])]),_:1}),e(p,null,{default:t(()=>[e(_,{type:"primary",size:"default",onClick:oe,disabled:!(o(h).length||o(C).length||o(k).length||o(z).length||o(E).length)},{default:t(()=>[c(" 搜索 ")]),_:1},8,["disabled"]),e(_,{size:"default",onClick:se},{default:t(()=>[c("重置")]),_:1})]),_:1})]),_:1})]),_:1}),e(J,null,{default:t(()=>[e(_,{type:"success",size:"default",onClick:re},{default:t(()=>[c(" 添加 ")]),_:1}),e(_,{type:"danger",size:"default",onClick:ce,disabled:!o(M).length},{default:t(()=>[c(" 批量删除 ")]),_:1},8,["disabled"]),e(Q,{border:"",data:o(x),onSelectionChange:ae,style:{margin:"15px 0"}},{default:t(()=>[e(d,{type:"selection",align:"center",width:"40px"}),e(d,{label:"id",align:"center",prop:"id",width:"50px"}),e(d,{label:"头像",align:"center",prop:"avatar","show-overflow-tooltip":"",width:"60px"},{default:t(({row:l})=>[Z("img",{src:l.avatar,alt:"头像",style:{width:"40px",height:"40px","border-radius":"50%"}},null,8,Je)]),_:1}),e(d,{label:"用户名字",align:"center",prop:"username","show-overflow-tooltip":""}),e(d,{label:"手机号",align:"center",prop:"phone","show-overflow-tooltip":""}),e(d,{label:"用户昵称",align:"center",prop:"nickname","show-overflow-tooltip":""}),e(d,{label:"工作",align:"center",prop:"job","show-overflow-tooltip":""}),e(d,{label:"邮箱",align:"center",prop:"email","show-overflow-tooltip":""}),e(d,{label:"城市",align:"center",prop:"city","show-overflow-tooltip":""}),e(d,{label:"个性签名",align:"center",prop:"signature","show-overflow-tooltip":""}),e(d,{label:"性别",align:"center",prop:"gender","show-overflow-tooltip":"",width:"60px"},{default:t(({row:l})=>[l.gender==="0"?(S(),N(B,{key:0,type:"warning"},{default:t(()=>[c("保密")]),_:1})):l.gender==="1"?(S(),N(B,{key:1,type:"primary"},{default:t(()=>[c("男")]),_:1})):(S(),N(B,{key:2,type:"success"},{default:t(()=>[c("女 ")]),_:1}))]),_:1}),e(d,{label:"状态",align:"center",prop:"status","show-overflow-tooltip":"",width:"60px"},{default:t(({row:l})=>[e(_e,{modelValue:l.status,"onUpdate:modelValue":L=>l.status=L,class:"ml-2",style:{"--el-switch-on-color":"#13ce66","--el-switch-off-color":"#ff4949"},"active-value":"1","inactive-value":"0",onChange:L=>o(fe)(l)},null,8,["modelValue","onUpdate:modelValue","onChange"])]),_:1}),e(d,{label:"创建时间",align:"center",prop:"creatTIme","show-overflow-tooltip":""}),e(d,{label:"操作",width:"280px",align:"center"},{default:t(({row:l})=>[e(_,{type:"primary",size:"small",icon:"Edit",onClick:L=>pe(l)},{default:t(()=>[c(" 编辑 ")]),_:2},1032,["onClick"]),e(K,{title:`你确定删除${l.username}`,width:"260px",onConfirm:L=>me(l.id)},{reference:t(()=>[e(_,{type:"danger",size:"small",icon:"Delete"},{default:t(()=>[c(" 删除 ")]),_:1})]),_:2},1032,["title","onConfirm"]),e(_,{type:"primary",size:"small",icon:"Edit",onClick:L=>o(ge)(l.id)},{default:t(()=>[c(" 登录日志 ")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"]),e(W,{"current-page":o(m),"onUpdate:currentPage":a[5]||(a[5]=l=>f(m)?m.value=l:m=l),"page-size":o(b),"onUpdate:pageSize":a[6]||(a[6]=l=>f(b)?b.value=l:b=l),"page-sizes":[5,10,15,20],background:!0,layout:"prev, pager, next, jumper, -> , sizes, total",total:o(D),onCurrentChange:U,onSizeChange:te},null,8,["current-page","page-size","total"])]),_:1}),e(X,{modelValue:o(V),"onUpdate:modelValue":a[16]||(a[16]=l=>f(V)?V.value=l:V=l),title:o(n).id?"更新会员":"添加会员"},{footer:t(()=>[Z("div",Qe,[e(_,{onClick:ne},{default:t(()=>[c("取消")]),_:1}),e(_,{type:"primary",onClick:ie},{default:t(()=>[c("确定")]),_:1})])]),default:t(()=>[e(H,{model:o(n),ref_key:"formRef",ref:w},{default:t(()=>[e(p,{label:"用户名",prop:"username"},{default:t(()=>[e(r,{placeholder:"请您输入用户名",modelValue:o(n).username,"onUpdate:modelValue":a[7]||(a[7]=l=>o(n).username=l)},null,8,["modelValue"])]),_:1}),e(p,{label:"昵称",prop:"nickname"},{default:t(()=>[e(r,{placeholder:"请您输入昵称",modelValue:o(n).nickname,"onUpdate:modelValue":a[8]||(a[8]=l=>o(n).nickname=l)},null,8,["modelValue"])]),_:1}),e(p,{label:"手机号",prop:"phone"},{default:t(()=>[e(r,{placeholder:"请您输入手机号",modelValue:o(n).phone,"onUpdate:modelValue":a[9]||(a[9]=l=>o(n).phone=l)},null,8,["modelValue"])]),_:1}),e(p,{label:"邮箱",prop:"email"},{default:t(()=>[e(r,{placeholder:"请您输入邮箱",modelValue:o(n).email,"onUpdate:modelValue":a[10]||(a[10]=l=>o(n).email=l)},null,8,["modelValue"])]),_:1}),e(p,{label:"城市",prop:"city"},{default:t(()=>[e(r,{placeholder:"请您输入城市",modelValue:o(n).city,"onUpdate:modelValue":a[11]||(a[11]=l=>o(n).city=l)},null,8,["modelValue"])]),_:1}),e(p,{label:"个性签名",prop:"signature"},{default:t(()=>[e(r,{placeholder:"请您输入个性签名",modelValue:o(n).signature,"onUpdate:modelValue":a[12]||(a[12]=l=>o(n).signature=l)},null,8,["modelValue"])]),_:1}),e(p,{label:"工作",prop:"job"},{default:t(()=>[e(r,{placeholder:"请您输入工作",modelValue:o(n).job,"onUpdate:modelValue":a[13]||(a[13]=l=>o(n).job=l)},null,8,["modelValue"])]),_:1}),e(p,{label:"性别",prop:"gender"},{default:t(()=>[e(T,{modelValue:o(n).gender,"onUpdate:modelValue":a[14]||(a[14]=l=>o(n).gender=l),class:"m-2",placeholder:"请选择性别"},{default:t(()=>[e(v,{label:"未知",value:"0"}),e(v,{label:"男",value:"1"}),e(v,{label:"女",value:"2"})]),_:1},8,["modelValue"])]),_:1}),e(p,{label:"状态",prop:"status"},{default:t(()=>[e(T,{modelValue:o(n).status,"onUpdate:modelValue":a[15]||(a[15]=l=>o(n).status=l),class:"m-2",placeholder:"请选择状态"},{default:t(()=>[e(v,{label:"正常",value:"1"}),e(v,{label:"禁用",value:"0"})]),_:1},8,["modelValue"])]),_:1}),e(p,{label:"头像",prop:"avatar"},{default:t(()=>[e(Ve,{class:"avatar-uploader",action:"/api/api/sys/upload","show-file-list":!1,"on-success":ue,"before-upload":de},{default:t(()=>[o(n).avatar?(S(),Y("img",{key:0,src:o(n).avatar,class:"avatar"},null,8,Ke)):(S(),N(ye,{key:1,class:"avatar-uploader-icon"},{default:t(()=>[e(be)]),_:1}))]),_:1})]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"]),e(X,{modelValue:o(P),"onUpdate:modelValue":a[19]||(a[19]=l=>f(P)?P.value=l:P=l),title:"登录日志"},{default:t(()=>[e(Q,{border:"",data:o(R)},{default:t(()=>[e(d,{label:"id",align:"center",prop:"id",width:"50px"}),e(d,{label:"IP",align:"center",prop:"ip","show-overflow-tooltip":""}),e(d,{label:"创建时间",align:"center",prop:"createTime","show-overflow-tooltip":""}),e(d,{label:"操作",width:"150px",align:"center"},{default:t(({row:l})=>[e(K,{title:"你确定删除吗",width:"260px",onConfirm:L=>ve(l.id)},{reference:t(()=>[e(_,{type:"danger",size:"small",icon:"Delete"},{default:t(()=>[c(" 删除 ")]),_:1})]),_:2},1032,["onConfirm"])]),_:1})]),_:1},8,["data"]),e(W,{"current-page":o(q),"onUpdate:currentPage":a[17]||(a[17]=l=>f(q)?q.value=l:q=l),"page-size":o(A),"onUpdate:pageSize":a[18]||(a[18]=l=>f(A)?A.value=l:A=l),"page-sizes":[5,10,15,20],background:!0,layout:"prev, pager, next, jumper, -> , sizes, total",total:o(O),onCurrentChange:o(I),onSizeChange:o(I)},null,8,["current-page","page-size","total","onCurrentChange","onSizeChange"])]),_:1},8,["modelValue"])],64)}}});export{ml as default};
