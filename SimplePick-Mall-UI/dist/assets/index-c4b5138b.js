/* empty css             *//* empty css                  *//* empty css                    *//* empty css                *//* empty css                        *//* empty css                 *//* empty css                      *//* empty css               *//* empty css                  *//* empty css                  *//* empty css                        *//* empty css                      *//* empty css                   *//* empty css                  *//* empty css                *//* empty css                     */import{r as oe,a as A,b as N}from"./index-87349f12.js";import{u as ne}from"./setting-343fd123.js";import{d as re,a as p,r as ue,aa as ie,a7 as u,A as pe,o as k,c as q,e,w as t,f as o,M as h,h as d,t as B,C as de,F as ce,k as me,m as _e,aj as fe,ak as ge,n as ve,p as ye,a5 as be,al as he,P as Ve,am as Ce,an as we,ao as Ee,ax as xe,G as ke,ac as ze,ap as Ue}from"./index-bc94ad6c.js";const Se=["src"],Pe=["src"],je={style:{flex:"auto"}},Ze=re({__name:"index",setup(Ie){let z=ne(),i=p(1),b=p(10),U=p(0),V=p([]),_=p(""),f=p(""),C=p([]),x=p([]);const D=s=>{x.value=s};let S=p(),c=p(!1),n=ue({id:0,name:"",status:"",sort:"",pic:""});ie(()=>{g()});const g=async(s=1)=>{i.value=s;let a=await oe(i.value,b.value,_.value,f.value);a.code==200?(U.value=a.total,V.value=a.data,u({type:"success",message:a.message})):u({type:"error",message:a.message})},G=()=>{g()},M=async s=>{C.value.push(s);const a={ids:C.value};let r=await A(a);r.code==200?(g(V.value.length>1?i.value:i.value-1),u({type:"success",message:r.message})):u({type:"error",message:r.message})},O=async()=>{C.value=x.value.map(r=>r.id);const s={ids:C.value};let a=await A(s);a.code===200?(g(V.value.length>1?i.value:i.value-1),u({type:"success",message:a.message})):u({type:"error",message:a.message})},R=()=>{g(),_.value="",f.value=""},T=()=>{z.refresh=!z.refresh},F=()=>{c.value=!0,Object.assign(n,{id:0,name:"",status:"1",sort:1,pic:""})},L=()=>{c.value=!1},H=s=>{c.value=!0,Object.assign(n,s)},J=s=>{n.pic=s.data,S.value.clearValidate("pic")},K=s=>{if(s.type==="image/png"||s.type==="image/jpeg"||s.type==="image/gif"){if(s.size/1024/1024<4)return!0;u({type:"error",message:"上传的文件大小应小于4M"})}else return u({type:"error",message:"上传的文件类型必须是PNG|JPG|GIF"}),!1},Q=async()=>{n.sort=parseInt(n.sort);let s=await N(n);s.code==200?(c.value=!1,u({type:"success",message:s.message}),g()):(c.value=!1,u({type:"error",message:s.message}))};let W=async s=>{let a={id:s.id,status:s.status},r=await N(a);r.code===200?u({type:"success",message:r.message}):u({type:"error",message:r.message})};return(s,a)=>{const r=me,v=_e,w=fe,P=ge,m=ve,j=ye,I=be,y=he,X=Ve,Y=Ce,Z=we,$=Ee,ee=xe,ae=pe("Plus"),le=ke,te=ze,se=Ue;return k(),q(ce,null,[e(I,null,{default:t(()=>[e(j,{inline:!0},{default:t(()=>[e(v,{label:"名称:"},{default:t(()=>[e(r,{placeholder:"请输入搜索的用户名",modelValue:o(_),"onUpdate:modelValue":a[0]||(a[0]=l=>h(_)?_.value=l:_=l)},null,8,["modelValue"])]),_:1}),e(v,{label:"状态:"},{default:t(()=>[e(P,{modelValue:o(f),"onUpdate:modelValue":a[1]||(a[1]=l=>h(f)?f.value=l:f=l),class:"m-2",placeholder:"请选择状态"},{default:t(()=>[e(w,{label:"正常",value:"1"}),e(w,{label:"禁用",value:"0"})]),_:1},8,["modelValue"])]),_:1}),e(v,null,{default:t(()=>[e(m,{type:"primary",size:"default",onClick:R,disabled:!(o(_)||o(f))},{default:t(()=>[d(" 搜索 ")]),_:1},8,["disabled"]),e(m,{size:"default",onClick:T},{default:t(()=>[d("重置")]),_:1})]),_:1})]),_:1})]),_:1}),e(I,null,{default:t(()=>[e(m,{type:"success",size:"default",onClick:F},{default:t(()=>[d(" 添加 ")]),_:1}),e(m,{type:"danger",size:"default",onClick:O,disabled:!o(x).length},{default:t(()=>[d(" 批量删除 ")]),_:1},8,["disabled"]),e(Z,{border:"",data:o(V),onSelectionChange:D,style:{margin:"15px 0"}},{default:t(()=>[e(y,{type:"selection",align:"center",width:"40px"}),e(y,{label:"id",align:"center",prop:"id",width:"50px"}),e(y,{label:"专题封面",align:"center",prop:"pic","show-overflow-tooltip":"",width:"120px"},{default:t(({row:l})=>[B("img",{src:l.pic,alt:"专题封面",style:{width:"100px",height:"auto"}},null,8,Se)]),_:1}),e(y,{label:"名称",align:"center",prop:"name","show-overflow-tooltip":""}),e(y,{label:"排序",align:"center",prop:"sort","show-overflow-tooltip":""}),e(y,{label:"状态",align:"center",prop:"status","show-overflow-tooltip":"",width:"60px"},{default:t(({row:l})=>[e(X,{modelValue:l.status,"onUpdate:modelValue":E=>l.status=E,class:"ml-2",style:{"--el-switch-on-color":"#13ce66","--el-switch-off-color":"#ff4949"},"active-value":"1","inactive-value":"0",onChange:E=>o(W)(l)},null,8,["modelValue","onUpdate:modelValue","onChange"])]),_:1}),e(y,{label:"操作",width:"300px",align:"center"},{default:t(({row:l})=>[e(m,{type:"primary",size:"small",icon:"Edit",onClick:E=>H(l)},{default:t(()=>[d(" 编辑 ")]),_:2},1032,["onClick"]),e(Y,{title:`你确定删除${l.name}`,width:"260px",onConfirm:E=>M(l.id)},{reference:t(()=>[e(m,{type:"danger",size:"small",icon:"Delete"},{default:t(()=>[d(" 删除 ")]),_:1})]),_:2},1032,["title","onConfirm"])]),_:1})]),_:1},8,["data"]),e($,{"current-page":o(i),"onUpdate:currentPage":a[2]||(a[2]=l=>h(i)?i.value=l:i=l),"page-size":o(b),"onUpdate:pageSize":a[3]||(a[3]=l=>h(b)?b.value=l:b=l),"page-sizes":[5,10,15,1],background:!0,layout:"prev, pager, next, jumper, -> , sizes, total",total:o(U),onCurrentChange:g,onSizeChange:G},null,8,["current-page","page-size","total"])]),_:1}),e(se,{modelValue:o(c),"onUpdate:modelValue":a[7]||(a[7]=l=>h(c)?c.value=l:c=l),title:o(n).id?"更新专题":"添加专题"},{footer:t(()=>[B("div",je,[e(m,{onClick:L},{default:t(()=>[d("取消")]),_:1}),e(m,{type:"primary",onClick:Q},{default:t(()=>[d("确定")]),_:1})])]),default:t(()=>[e(j,{model:o(n),ref_key:"formRef",ref:S},{default:t(()=>[e(v,{label:"名称",prop:"name"},{default:t(()=>[e(r,{placeholder:"请您输入名称",modelValue:o(n).name,"onUpdate:modelValue":a[4]||(a[4]=l=>o(n).name=l)},null,8,["modelValue"])]),_:1}),e(v,{label:"排序"},{default:t(()=>[d(" 排在第"),e(ee,{modelValue:o(n).sort,"onUpdate:modelValue":a[5]||(a[5]=l=>o(n).sort=l),min:1,size:"small","controls-position":"right"},null,8,["modelValue"]),d("位 ")]),_:1}),e(v,{label:"状态",prop:"status"},{default:t(()=>[e(P,{modelValue:o(n).status,"onUpdate:modelValue":a[6]||(a[6]=l=>o(n).status=l),class:"m-2",placeholder:"请选择状态"},{default:t(()=>[e(w,{label:"不显示",value:"0"}),e(w,{label:"显示",value:"1"})]),_:1},8,["modelValue"])]),_:1}),e(v,{label:"封面",prop:"pic"},{default:t(()=>[e(te,{class:"avatar-uploader",action:"/api/api/sys/upload","show-file-list":!1,"on-success":J,"before-upload":K},{default:t(()=>[o(n).pic?(k(),q("img",{key:0,src:o(n).pic,class:"avatar"},null,8,Pe)):(k(),de(le,{key:1,class:"avatar-uploader-icon"},{default:t(()=>[e(ae)]),_:1}))]),_:1})]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"])],64)}}});export{Ze as default};
