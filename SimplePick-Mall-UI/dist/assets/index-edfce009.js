/* empty css             *//* empty css                  *//* empty css                     *//* empty css                    *//* empty css                *//* empty css                        *//* empty css                 *//* empty css               *//* empty css                  *//* empty css                  *//* empty css                *//* empty css                        *//* empty css                      *//* empty css                   */import{r as L,a as H,b as J}from"./index-2b6b338a.js";import{d as W,a as _,aa as K,a7 as d,av as Q,r as X,A as Y,o as c,c as x,e,w as a,h as p,f as n,t as C,C as y,z as h,x as Z,M as w,aw as ee,F as ae,n as te,al as le,ah as oe,am as se,an as ne,a5 as re,k as pe,m as ie,aj as de,ak as ue,ax as me,G as ce,ac as _e,p as fe,ap as ge}from"./index-bc94ad6c.js";const ve=["src"],ye=["src"],be={class:"dialog-footer"},je=W({__name:"index",setup(Ve){let b=_(),f=_([]),r=_(!1),g=_([]);K(()=>{v()});const v=async()=>{let l=await L();l.code===200?(f.value=l.data,d({type:"success",message:l.message})):d({type:"error",message:l.message})},I=Q(()=>[{id:0,name:"无上级"},...f.value]);let o=X({description:"",icon:"",keywords:"",level:"",name:"",navStatus:"",parentId:0,productCount:0,productUnit:"",showStatus:"",sort:0});const U=()=>{Object.assign(o,{id:0,description:"",icon:"",keywords:"",level:"",name:"",navStatus:"",parentId:0,productCount:0,productUnit:"",showStatus:"",sort:0}),r.value=!0},S=l=>{r.value=!0,o.parentId=parseInt(l.parentId),Object.assign(o,l)},A=async()=>{r.value=!1;let l=await H(o);l.code===200?(r.value=!1,v(),d({type:"success",message:l.message})):d({type:"error",message:l.message})},z=async l=>{g.value.push(l);const s={ids:g.value};let i=await J(s);i.code==200?(g.value=[],v(),d({type:"success",message:i.message})):d({type:"error",message:i.message})},N=l=>{o.icon=l.data,b.value.clearValidate("icon")},P=l=>{if(l.type==="image/png"||l.type==="image/jpeg"||l.type==="image/gif"){if(l.size/1024/1024<4)return!0;d({type:"error",message:"上传的文件大小应小于4M"})}else return d({type:"error",message:"上传的文件类型必须是PNG|JPG|GIF"}),!1};return(l,s)=>{const i=te,u=le,V=oe,B=se,R=ne,T=re,k=pe,m=ie,E=de,j=ue,q=me,D=Y("Plus"),G=ce,M=_e,O=fe,$=ge;return c(),x(ae,null,[e(T,null,{default:a(()=>[e(i,{type:"success",size:"default",icon:"Plus",onClick:U},{default:a(()=>[p(" 添加 ")]),_:1}),e(R,{style:{margin:"15px 0"},"row-key":"id",border:"",data:n(f)},{default:a(()=>[e(u,{prop:"name",label:"名称"}),e(u,{label:"图标",align:"center",prop:"icon","show-overflow-tooltip":"",width:"120px"},{default:a(({row:t})=>[C("img",{src:t.icon,alt:"图标",style:{width:"60px",height:"auto"}},null,8,ve)]),_:1}),e(u,{label:"类型",align:"center",prop:"level","show-overflow-tooltip":""},{default:a(({row:t})=>[t.level==="1"?(c(),y(V,{key:0,class:"mx-1",type:"success",effect:"light"},{default:a(()=>[p(" 一级目录 ")]),_:1})):h("",!0),t.level==="2"?(c(),y(V,{key:1,class:"mx-1",type:"warning",effect:"light"},{default:a(()=>[p(" 二级目录 ")]),_:1})):h("",!0)]),_:1}),e(u,{prop:"description",label:"描述"}),e(u,{prop:"sort",label:"排序"},{default:a(({row:t})=>[p(" 当前排"+Z(t.sort)+"位 ",1)]),_:1}),e(u,{label:"操作",width:"260px"},{default:a(({row:t})=>[e(i,{type:"primary",size:"small",onClick:F=>S(t)},{default:a(()=>[p(" 编辑 ")]),_:2},1032,["onClick"]),e(B,{title:`你确定要删除${t.name}?`,width:"260px",onConfirm:F=>z(t.id)},{reference:a(()=>[e(i,{type:"danger",size:"small"},{default:a(()=>[p(" 删除 ")]),_:1})]),_:2},1032,["title","onConfirm"])]),_:1})]),_:1},8,["data"])]),_:1}),e($,{modelValue:n(r),"onUpdate:modelValue":s[6]||(s[6]=t=>w(r)?r.value=t:r=t),title:n(o).id?"更新":"添加"},{footer:a(()=>[C("span",be,[e(i,{onClick:s[5]||(s[5]=t=>w(r)?r.value=!1:r=!1)},{default:a(()=>[p("取消")]),_:1}),e(i,{type:"primary",onClick:A},{default:a(()=>[p("确定")]),_:1})])]),default:a(()=>[e(O,{ref_key:"formRef",ref:b},{default:a(()=>[e(m,{label:"名称"},{default:a(()=>[e(k,{placeholder:"请你输入菜单的名称",modelValue:n(o).name,"onUpdate:modelValue":s[0]||(s[0]=t=>n(o).name=t)},null,8,["modelValue"])]),_:1}),e(m,{label:"类型"},{default:a(()=>[e(j,{modelValue:n(o).level,"onUpdate:modelValue":s[1]||(s[1]=t=>n(o).level=t),class:"m-2",placeholder:"请选择类型"},{default:a(()=>[e(E,{label:"一级目录",value:"1"}),e(E,{label:"二级目录",value:"2"})]),_:1},8,["modelValue"])]),_:1}),e(m,{label:"父级id"},{default:a(()=>[e(n(ee),{modelValue:n(o).parentId,"onUpdate:modelValue":s[2]||(s[2]=t=>n(o).parentId=t),data:I.value,"check-strictly":"",props:{key:"id",label:"name"},"node-key":"id","render-after-expand":!1},null,8,["modelValue","data"])]),_:1}),e(m,{label:"排序"},{default:a(()=>[p(" 排在第"),e(q,{modelValue:n(o).sort,"onUpdate:modelValue":s[3]||(s[3]=t=>n(o).sort=t),min:1,size:"small","controls-position":"right"},null,8,["modelValue"]),p("位 ")]),_:1}),e(m,{label:"描述"},{default:a(()=>[e(k,{placeholder:"请你输入描述",modelValue:n(o).description,"onUpdate:modelValue":s[4]||(s[4]=t=>n(o).description=t)},null,8,["modelValue"])]),_:1}),e(m,{label:"图标",prop:"pic"},{default:a(()=>[e(M,{class:"avatar-uploader",action:"/api/api/sys/upload","show-file-list":!1,"on-success":N,"before-upload":P},{default:a(()=>[n(o).icon?(c(),x("img",{key:0,src:n(o).icon,class:"avatar"},null,8,ye)):(c(),y(G,{key:1,class:"avatar-uploader-icon"},{default:a(()=>[e(D)]),_:1}))]),_:1})]),_:1})]),_:1},512)]),_:1},8,["modelValue","title"])],64)}}});export{je as default};
